(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[237],{4280:function(e,s,t){Promise.resolve().then(t.bind(t,9864))},9864:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var r=t(5650),a=t(3966),n=t(9856),i=t(2317),l=t(9216);function o(e){let{isOpen:s,onClose:t,roleId:a,roleName:n,onPermissionsUpdated:o}=e,[c,d]=(0,i.useState)([]),[m,u]=(0,i.useState)(new Set),[x,g]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!1),[y,f]=(0,i.useState)(""),[b,v]=(0,i.useState)("all");(0,i.useEffect)(()=>{s&&a&&j()},[s,a]);let j=async()=>{g(!0);try{var e;let s=await l.J2.getAllGrouped();d(s.data||[]);let t=await l.h0.getRolePermissions(a),r=(null===(e=t.data)||void 0===e?void 0:e.map(e=>e.id))||[];u(new Set(r))}catch(e){console.error("Error loading permissions:",e)}finally{g(!1)}},N=e=>{let s=new Set(m);s.has(e)?s.delete(e):s.add(e),u(s)},w=(e,s)=>{let t=new Set(m),r=s.every(e=>t.has(e.id));s.every(e=>!t.has(e.id)),r?s.forEach(e=>t.delete(e.id)):s.forEach(e=>t.add(e.id)),u(t)},S=async()=>{h(!0);try{let e=Array.from(m);await l.h0.assignPermissions(a,e),o(),t()}catch(e){console.error("Error saving permissions:",e),alert("Failed to save permissions. Please try again.")}finally{h(!1)}},C=c.map(e=>({...e,permissions:e.permissions.filter(s=>{var t;return("all"===b||e.module===b)&&(""===y||s.name.toLowerCase().includes(y.toLowerCase())||s.code.toLowerCase().includes(y.toLowerCase())||(null===(t=s.description)||void 0===t?void 0:t.toLowerCase().includes(y.toLowerCase())))})})).filter(e=>e.permissions.length>0),k=Array.from(new Set(c.map(e=>e.module)));return s?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Manage Permissions for ",n]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Assign or remove permissions from this role"})]}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})}),(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",placeholder:"Search permissions...",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Modules"}),k.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-auto max-h-[60vh]",children:x?(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading permissions..."})]}):(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[C.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:e.permissions.every(e=>m.has(e.id)),onChange:()=>w(e.module,e.permissions),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 capitalize",children:e.module.replace("_"," ")}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.permissions.length," permissions)"]})]})})}),(0,r.jsx)("div",{className:"p-4 space-y-3",children:e.permissions.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 border border-gray-100 rounded-lg hover:bg-gray-50",children:[(0,r.jsx)("input",{type:"checkbox",checked:m.has(e.id),onChange:()=>N(e.id),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsx)("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-600",children:e.code}),e.isSystemPermission&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"System"})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["Action: ",(0,r.jsx)("strong",{children:e.action})]}),(0,r.jsxs)("span",{children:["Scope: ",(0,r.jsx)("strong",{children:e.scope})]}),(0,r.jsxs)("span",{children:["Resource: ",(0,r.jsx)("strong",{children:e.resourceType})]})]})]})]},e.id))})]},e.module)),0===C.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0D"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No permissions found"}),(0,r.jsx)("p",{className:"text-gray-600",children:y?"Try a different search term":"No permissions available"})]})]})}),(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[m.size," permission",1!==m.size?"s":""," assigned"]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",disabled:p,children:"Cancel"}),(0,r.jsx)("button",{onClick:S,disabled:p,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Saving...":"Save Permissions"})]})]})})]})}):null}function c(){let{user:e}=(0,a.t)();(0,n.useRouter)();let[s,t]=(0,i.useState)([]),[c,d]=(0,i.useState)(!0),[m,u]=(0,i.useState)(""),[x,g]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[y,f]=(0,i.useState)({name:"",description:""}),[b,v]=(0,i.useState)(""),[j,N]=(0,i.useState)(""),[w,S]=(0,i.useState)(null),[C,k]=(0,i.useState)(!1),[A,I]=(0,i.useState)(null);(0,i.useEffect)(()=>{e&&P()},[e]);let P=async()=>{try{d(!0);let e=await l.h0.getAllWithUserCount();t(e.data||[])}catch(e){console.error("Error loading roles:",e),v("Failed to load roles")}finally{d(!1)}},R=async()=>{if(!y.name.trim()){v("Role name is required");return}try{await (0,l.ac)().post("/roles",y),N("Role created successfully"),g(!1),f({name:"",description:""}),P(),setTimeout(()=>N(""),3e3)}catch(t){var e,s;v((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to create role")}},D=e=>{h(e),f({name:e.name,description:e.description}),g(!0)},L=async e=>{if(confirm("Are you sure you want to delete this role?"))try{await (0,l.ac)().delete("/roles/".concat(e)),N("Role deleted successfully"),P(),setTimeout(()=>N(""),3e3)}catch(e){var s,t;v((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to delete role")}},_=e=>{I({id:e.id,name:e.name}),k(!0)},E=async e=>{let s=prompt("Enter name for cloned role (original: ".concat(e.name,"):"),"".concat(e.name," (Copy)"));if(s&&s.trim())try{await l.h0.cloneRole(e.id,{name:s.trim(),description:e.description}),N("Role cloned successfully"),P(),setTimeout(()=>N(""),3e3)}catch(e){var t,r;v((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to clone role")}},T=s.filter(e=>{var s;return e.name.toLowerCase().includes(m.toLowerCase())||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(m.toLowerCase()))});return c||!e?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading roles..."})]})}):(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Role Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage roles and permissions"})]}),(0,r.jsx)("button",{onClick:()=>{h(null),f({name:"",description:""}),g(!0)},className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition",children:"+ Create Role"})]}),j&&(0,r.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg",children:j}),b&&(0,r.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[b,(0,r.jsx)("button",{onClick:()=>v(""),className:"float-right font-bold",children:"\xd7"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("input",{type:"text",placeholder:"Search roles...",value:m,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:c?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading roles..."})]}):0===T.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD10"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Roles Found"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:m?"Try a different search term":"Create your first role to get started"}),!m&&(0,r.jsx)("button",{onClick:()=>g(!0),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700",children:"Create Role"})]}):(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Count"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.name})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e.description||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("button",{onClick:()=>S(w===e.id?null:e.id),className:"flex items-center gap-2 text-sm font-medium text-indigo-600 hover:text-indigo-800",children:[(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[e.userCount||0," users"]}),(0,r.jsx)("span",{className:"text-xs",children:w===e.id?"▼":"▶"})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(!1!==e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:!1!==e.isActive?"Active":"Inactive"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>D(e),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>_(e),className:"text-green-600 hover:text-green-900 mr-4",children:"Permissions"}),(0,r.jsx)("button",{onClick:()=>E(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Clone"}),(0,r.jsx)("button",{onClick:()=>L(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id),w===e.id&&e.users&&e.users.length>0&&(0,r.jsx)("tr",{className:"bg-gray-50",children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Assigned Users:"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.users.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-white px-3 py-2 rounded border",children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.firstName," ",e.lastName]}),(0,r.jsx)("span",{className:"text-gray-400",children:"•"}),(0,r.jsx)("span",{className:"text-xs",children:e.email})]},e.id))})]})})})]}))})]})})]}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:p?"Edit Role":"Create New Role"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name *"}),(0,r.jsx)("input",{type:"text",value:y.name,onChange:e=>f({...y,name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Doctor, Nurse, Admin"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("textarea",{value:y.description,onChange:e=>f({...y,description:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Describe the role's responsibilities...",rows:3})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{g(!1),h(null),f({name:"",description:""}),v("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{onClick:R,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:p?"Update":"Create"})]})]})}),C&&A&&(0,r.jsx)(o,{isOpen:C,onClose:()=>{k(!1),I(null)},roleId:A.id,roleName:A.name,onPermissionsUpdated:()=>{N("Permissions updated successfully"),P(),setTimeout(()=>N(""),3e3)}})]})}},9216:function(e,s,t){"use strict";let r;t.d(s,{Di:function(){return o},J2:function(){return x},WU:function(){return g},ac:function(){return l},g8:function(){return m},h0:function(){return u},h5:function(){return c},iJ:function(){return d},qN:function(){return i},sl:function(){return p}});var a=t(6470),n=t(3966);t(2189);let i=()=>((r=a.Z.create({baseURL:"http://localhost:5073/api",headers:{"Content-Type":"application/json"}})).interceptors.request.use(e=>{let{tenantId:s,token:t}=n.t.getState();return s&&(e.headers["X-Tenant-ID"]=s),t&&(e.headers.Authorization="Bearer ".concat(t)),e}),r.interceptors.response.use(e=>e,e=>{var s,t;return(null===(s=e.response)||void 0===s?void 0:s.status)===401?(n.t.getState().logout(),window.location.href="/auth/login"):(null===(t=e.response)||void 0===t?void 0:t.status)===403&&(window.location.href="/dashboard/unauthorized"),Promise.reject(e)}),r),l=()=>r||i(),o={getAll:()=>l().get("/patients"),getById:e=>l().get("/patients/".concat(e)),create:e=>l().post("/patients",e),update:(e,s)=>l().put("/patients/".concat(e),s),delete:e=>l().delete("/patients/".concat(e))},c={getAll:()=>l().get("/examinations"),getById:e=>l().get("/examinations/".concat(e)),getByPatient:e=>l().get("/examinations/patient/".concat(e)),create:e=>l().post("/examinations",e),update:(e,s)=>l().put("/examinations/".concat(e),s),delete:e=>l().delete("/examinations/".concat(e))},d={login:(e,s,t)=>l().post("/auth/login",{email:e,password:s,tenantId:t}),changePassword:(e,s)=>l().post("/auth/change-password",{currentPassword:e,newPassword:s})},m={getAll:()=>l().get("/users"),getAllWithDetails:()=>l().get("/users/with-details"),getById:e=>l().get("/users/".concat(e)),create:e=>l().post("/users",e),update:(e,s)=>l().put("/users/".concat(e),s),deactivate:e=>l().post("/users/".concat(e,"/deactivate"))},u={getAll:()=>l().get("/roles"),getAllWithUserCount:()=>l().get("/roles/with-user-count"),getById:e=>l().get("/roles/".concat(e)),create:e=>l().post("/roles",e),update:(e,s)=>l().put("/roles/".concat(e),s),delete:e=>l().delete("/roles/".concat(e)),assignRole:(e,s,t)=>l().post("/users/".concat(e,"/roles"),{roleId:s,branchId:t}),getRolePermissions:e=>l().get("/roles/".concat(e,"/permissions")),assignPermissions:(e,s)=>l().post("/roles/".concat(e,"/permissions"),{permissionIds:s}),removePermissions:(e,s)=>l().delete("/roles/".concat(e,"/permissions"),{data:{permissionIds:s}}),cloneRole:(e,s,t)=>l().post("/roles/".concat(e,"/clone"),{name:s,description:t})},x={getAll:()=>l().get("/permissions"),getAllGrouped:()=>l().get("/permissions/grouped"),getById:e=>l().get("/permissions/".concat(e)),create:e=>l().post("/permissions",e),update:(e,s)=>l().put("/permissions/".concat(e),s),delete:e=>l().delete("/permissions/".concat(e)),getByCategory:e=>l().get("/permissions/category/".concat(e)),bulkAssign:(e,s)=>l().post("/permissions/bulk-assign",{roleId:e,permissionIds:s}),bulkRemove:(e,s)=>l().delete("/permissions/bulk-remove",{data:{roleId:e,permissionIds:s}}),getMatrix:()=>l().get("/permissions/matrix"),getStatistics:()=>l().get("/permissions/statistics")},g={getAll:()=>l().get("/departments"),getAllWithStaffCount:()=>l().get("/departments/with-staff-count"),getById:e=>l().get("/departments/".concat(e))},p={getAll:()=>l().get("/branches")}},2189:function(e,s,t){"use strict";t.d(s,{f:function(){return a}});var r=t(9216);let a={assign:async function(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,r.ac)().post("/users/".concat(e,"/department-access"),{departmentId:s,accessLevel:t,isPrimary:a})},revoke:async(e,s)=>(0,r.ac)().delete("/users/".concat(e,"/department-access/").concat(s)),getUserDepartments:async e=>{let s=await (0,r.ac)().get("/users/".concat(e,"/department-access"));return s.data},getDepartmentUsers:async e=>(0,r.ac)().get("/departments/".concat(e,"/user-access")),updateAccessLevel:async(e,s,t)=>(0,r.ac)().put("/users/".concat(e,"/department-access/").concat(s),{accessLevel:t}),setPrimary:async(e,s)=>(0,r.ac)().put("/users/".concat(e,"/department-access/").concat(s),{isPrimary:!0}),bulkAssign:async e=>(0,r.ac)().post("/user-department-access/bulk-assign",{assignments:e}),getAccessMatrix:async e=>{let s=e?{departmentId:e}:{};return(0,r.ac)().get("/user-department-access/matrix",{params:s})}}},3966:function(e,s,t){"use strict";t.d(s,{R:function(){return n},t:function(){return a}});var r=t(9147);let a=(0,r.Ue)((e,s)=>({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],isLoading:!1,mustChangePassword:!1,setAuth:(s,t,r,a,n,i,l)=>{e({token:s,refreshToken:t,user:r,roles:a,permissions:n,tenantId:i,mustChangePassword:l}),localStorage.setItem("auth_token",s),localStorage.setItem("refresh_token",t),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("roles",JSON.stringify(a)),localStorage.setItem("permissions",JSON.stringify(n)),localStorage.setItem("tenant_id",i)},logout:()=>{e({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],mustChangePassword:!1}),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("tenant_id")},clearMustChangePassword:()=>e({mustChangePassword:!1}),hasPermission:e=>{let{permissions:t}=s();return!!(t&&Array.isArray(t))&&(!!t.includes("*")||t.includes(e))},hasRole:e=>{let{roles:t}=s();return!!(t&&Array.isArray(t))&&t.includes(e)}}));function n(){try{let e=localStorage.getItem("auth_token"),s=localStorage.getItem("refresh_token"),t=localStorage.getItem("user"),r=localStorage.getItem("roles"),n=localStorage.getItem("permissions"),i=localStorage.getItem("tenant_id");if(e&&t){let l=JSON.parse(t),o=r?JSON.parse(r):[],c=n?JSON.parse(n):[];a.getState().setAuth(e,s||null,l,o,c,i||null,a.getState().mustChangePassword)}}catch(e){console.warn("Failed to hydrate auth from storage",e)}}},9856:function(e,s,t){e.exports=t(39)}},function(e){e.O(0,[675,510,662,744],function(){return e(e.s=4280)}),_N_E=e.O()}]);