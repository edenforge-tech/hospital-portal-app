(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{1757:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(2317);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(...e)=>e.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:o,...d},u)=>(0,a.createElement)("svg",{ref:u,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:n("lucide",i),...d},[...o.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(l)?l:[l]])),l=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...c},l)=>(0,a.createElement)(i,{ref:l,iconNode:t,className:n(`lucide-${r(e)}`,s),...c}));return s.displayName=`${e}`,s}},9542:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8541:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},7109:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},3452:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},982:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},5273:function(e,t,s){Promise.resolve().then(s.bind(s,8685))},8685:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(5650),r=s(2317),n=s(3966),c=s(9216);let i={getMyDevices:async()=>(0,c.ac)().get("/device-management/my-devices"),getUserDevices:async e=>(0,c.ac)().get("/device-management/user/".concat(e,"/devices")),register:async e=>(0,c.ac)().post("/device-management/register",e),setTrustLevel:async(e,t)=>(0,c.ac)().put("/device-management/".concat(e,"/trust-level"),{trustLevel:t}),setPrimary:async e=>(0,c.ac)().put("/device-management/".concat(e,"/set-primary"),{}),block:async(e,t)=>(0,c.ac)().put("/device-management/".concat(e,"/block"),{reason:t}),unblock:async e=>(0,c.ac)().put("/device-management/".concat(e,"/unblock"),{}),delete:async e=>(0,c.ac)().delete("/device-management/".concat(e))};var l=s(982),o=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,o.Z)("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);var u=s(7109);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,o.Z)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var g=s(3452);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,o.Z)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),x=(0,o.Z)("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]);var y=s(8541),h=s(9542);function v(){let{user:e}=(0,n.t)(),[t,s]=(0,r.useState)([]),[c,o]=(0,r.useState)(!0),[v,f]=(0,r.useState)(null),[b,k]=(0,r.useState)(null);(0,r.useEffect)(()=>{e&&w()},[e]);let w=async()=>{try{o(!0),f(null);let e=await i.getMyDevices();s(e.data||[])}catch(s){var e,t;console.error("Error loading devices:",s),f((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load devices")}finally{o(!1)}},N=async e=>{try{f(null),k(null),await i.setPrimary(e),k("Primary device updated successfully"),await w()}catch(e){var t,s;f((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to set primary device")}},j=async e=>{let t=prompt("Enter reason for blocking this device:");if(t)try{f(null),k(null),await i.block(e,t),k("Device blocked successfully"),await w()}catch(e){var s,a;f((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to block device")}},S=async e=>{try{f(null),k(null),await i.unblock(e),k("Device unblocked successfully"),await w()}catch(e){var t,s;f((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to unblock device")}},A=async(e,t)=>{try{f(null),k(null),await i.setTrustLevel(e,t),k("Device trust level updated successfully"),await w()}catch(e){var s,a;f((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to update trust level")}},C=e=>{switch(null==e?void 0:e.toLowerCase()){case"mobile":return(0,a.jsx)(l.Z,{className:"text-blue-600",size:24});case"tablet":return(0,a.jsx)(d,{className:"text-purple-600",size:24});default:return(0,a.jsx)(u.Z,{className:"text-gray-600",size:24})}},I=e=>{switch(e){case"Verified":return(0,a.jsx)(m,{className:"text-green-600",size:20});case"Trusted":return(0,a.jsx)(g.Z,{className:"text-blue-600",size:20});default:return(0,a.jsx)(p,{className:"text-yellow-600",size:20})}},P=e=>{let t={Verified:"bg-green-100 text-green-800",Trusted:"bg-blue-100 text-blue-800",Untrusted:"bg-yellow-100 text-yellow-800"};return t[e]||t.Untrusted};return c?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"My Devices"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Manage devices that have access to your account"})]}),v&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:v}),b&&(0,a.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:b}),(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-2 ".concat(e.isPrimaryDevice?"border-indigo-500":"border-gray-200"," ").concat(e.isBlocked?"opacity-60":""),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[C(e.deviceType),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.deviceName||"".concat(e.deviceType||"Device")}),e.isPrimaryDevice&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800",children:"Primary"})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-1",children:I(e.trustLevel)})]}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat(P(e.trustLevel)),children:e.trustLevel})}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.os&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x,{size:16}),(0,a.jsxs)("span",{children:[e.os," ",e.osVersion&&"(".concat(e.osVersion,")")]})]}),e.location&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.Z,{size:16}),(0,a.jsx)("span",{children:e.location})]}),e.lastLoginAt&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{size:16}),(0,a.jsxs)("span",{children:["Last login: ",new Date(e.lastLoginAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Total logins: ",e.totalLogins]})]}),e.isBlocked&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Blocked"}),e.blockReason&&(0,a.jsx)("p",{className:"text-xs mt-1",children:e.blockReason})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[!e.isPrimaryDevice&&!e.isBlocked&&(0,a.jsx)("button",{onClick:()=>N(e.id),className:"w-full px-3 py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded hover:bg-indigo-100",children:"Set as Primary"}),"Verified"!==e.trustLevel&&!e.isBlocked&&(0,a.jsx)("button",{onClick:()=>A(e.id,"Verified"),className:"w-full px-3 py-2 text-sm font-medium text-green-600 bg-green-50 rounded hover:bg-green-100",children:"Mark as Verified"}),e.isBlocked?(0,a.jsx)("button",{onClick:()=>S(e.id),className:"w-full px-3 py-2 text-sm font-medium text-green-600 bg-green-50 rounded hover:bg-green-100",children:"Unblock Device"}):(0,a.jsx)("button",{onClick:()=>j(e.id),className:"w-full px-3 py-2 text-sm font-medium text-red-600 bg-red-50 rounded hover:bg-red-100",children:"Block Device"})]})]},e.id))}),0===t.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(l.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No devices"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No devices have been registered for your account yet."})]})]})}},9216:function(e,t,s){"use strict";let a;s.d(t,{Di:function(){return l},J2:function(){return g},WU:function(){return p},ac:function(){return i},g8:function(){return u},h0:function(){return m},h5:function(){return o},iJ:function(){return d},qN:function(){return c},sl:function(){return x}});var r=s(6470),n=s(3966);s(2189);let c=()=>((a=r.Z.create({baseURL:"http://localhost:5073/api",headers:{"Content-Type":"application/json"}})).interceptors.request.use(e=>{let{tenantId:t,token:s}=n.t.getState();return t&&(e.headers["X-Tenant-ID"]=t),s&&(e.headers.Authorization="Bearer ".concat(s)),e}),a.interceptors.response.use(e=>e,e=>{var t,s;return(null===(t=e.response)||void 0===t?void 0:t.status)===401?(n.t.getState().logout(),window.location.href="/auth/login"):(null===(s=e.response)||void 0===s?void 0:s.status)===403&&(window.location.href="/dashboard/unauthorized"),Promise.reject(e)}),a),i=()=>a||c(),l={getAll:()=>i().get("/patients"),getById:e=>i().get("/patients/".concat(e)),create:e=>i().post("/patients",e),update:(e,t)=>i().put("/patients/".concat(e),t),delete:e=>i().delete("/patients/".concat(e))},o={getAll:()=>i().get("/examinations"),getById:e=>i().get("/examinations/".concat(e)),getByPatient:e=>i().get("/examinations/patient/".concat(e)),create:e=>i().post("/examinations",e),update:(e,t)=>i().put("/examinations/".concat(e),t),delete:e=>i().delete("/examinations/".concat(e))},d={login:(e,t,s)=>i().post("/auth/login",{email:e,password:t,tenantId:s}),changePassword:(e,t)=>i().post("/auth/change-password",{currentPassword:e,newPassword:t})},u={getAll:()=>i().get("/users"),getAllWithDetails:()=>i().get("/users/with-details"),getById:e=>i().get("/users/".concat(e)),create:e=>i().post("/users",e),update:(e,t)=>i().put("/users/".concat(e),t),deactivate:e=>i().post("/users/".concat(e,"/deactivate"))},m={getAll:()=>i().get("/roles"),getAllWithUserCount:()=>i().get("/roles/with-user-count"),getById:e=>i().get("/roles/".concat(e)),create:e=>i().post("/roles",e),update:(e,t)=>i().put("/roles/".concat(e),t),delete:e=>i().delete("/roles/".concat(e)),assignRole:(e,t,s)=>i().post("/users/".concat(e,"/roles"),{roleId:t,branchId:s}),getRolePermissions:e=>i().get("/roles/".concat(e,"/permissions")),assignPermissions:(e,t)=>i().post("/roles/".concat(e,"/permissions"),{permissionIds:t}),removePermissions:(e,t)=>i().delete("/roles/".concat(e,"/permissions"),{data:{permissionIds:t}}),cloneRole:(e,t,s)=>i().post("/roles/".concat(e,"/clone"),{name:t,description:s})},g={getAll:()=>i().get("/permissions"),getAllGrouped:()=>i().get("/permissions/grouped"),getById:e=>i().get("/permissions/".concat(e)),create:e=>i().post("/permissions",e),update:(e,t)=>i().put("/permissions/".concat(e),t),delete:e=>i().delete("/permissions/".concat(e)),getByCategory:e=>i().get("/permissions/category/".concat(e)),bulkAssign:(e,t)=>i().post("/permissions/bulk-assign",{roleId:e,permissionIds:t}),bulkRemove:(e,t)=>i().delete("/permissions/bulk-remove",{data:{roleId:e,permissionIds:t}}),getMatrix:()=>i().get("/permissions/matrix"),getStatistics:()=>i().get("/permissions/statistics")},p={getAll:()=>i().get("/departments"),getAllWithStaffCount:()=>i().get("/departments/with-staff-count"),getById:e=>i().get("/departments/".concat(e))},x={getAll:()=>i().get("/branches")}},2189:function(e,t,s){"use strict";s.d(t,{f:function(){return r}});var a=s(9216);let r={assign:async function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.ac)().post("/users/".concat(e,"/department-access"),{departmentId:t,accessLevel:s,isPrimary:r})},revoke:async(e,t)=>(0,a.ac)().delete("/users/".concat(e,"/department-access/").concat(t)),getUserDepartments:async e=>{let t=await (0,a.ac)().get("/users/".concat(e,"/department-access"));return t.data},getDepartmentUsers:async e=>(0,a.ac)().get("/departments/".concat(e,"/user-access")),updateAccessLevel:async(e,t,s)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{accessLevel:s}),setPrimary:async(e,t)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{isPrimary:!0}),bulkAssign:async e=>(0,a.ac)().post("/user-department-access/bulk-assign",{assignments:e}),getAccessMatrix:async e=>{let t=e?{departmentId:e}:{};return(0,a.ac)().get("/user-department-access/matrix",{params:t})}}},3966:function(e,t,s){"use strict";s.d(t,{R:function(){return n},t:function(){return r}});var a=s(9147);let r=(0,a.Ue)((e,t)=>({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],isLoading:!1,mustChangePassword:!1,setAuth:(t,s,a,r,n,c,i)=>{e({token:t,refreshToken:s,user:a,roles:r,permissions:n,tenantId:c,mustChangePassword:i}),localStorage.setItem("auth_token",t),localStorage.setItem("refresh_token",s),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("roles",JSON.stringify(r)),localStorage.setItem("permissions",JSON.stringify(n)),localStorage.setItem("tenant_id",c)},logout:()=>{e({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],mustChangePassword:!1}),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("tenant_id")},clearMustChangePassword:()=>e({mustChangePassword:!1}),hasPermission:e=>{let{permissions:s}=t();return!!(s&&Array.isArray(s))&&(!!s.includes("*")||s.includes(e))},hasRole:e=>{let{roles:s}=t();return!!(s&&Array.isArray(s))&&s.includes(e)}}));function n(){try{let e=localStorage.getItem("auth_token"),t=localStorage.getItem("refresh_token"),s=localStorage.getItem("user"),a=localStorage.getItem("roles"),n=localStorage.getItem("permissions"),c=localStorage.getItem("tenant_id");if(e&&s){let i=JSON.parse(s),l=a?JSON.parse(a):[],o=n?JSON.parse(n):[];r.getState().setAuth(e,t||null,i,l,o,c||null,r.getState().mustChangePassword)}}catch(e){console.warn("Failed to hydrate auth from storage",e)}}}},function(e){e.O(0,[675,510,662,744],function(){return e(e.s=5273)}),_N_E=e.O()}]);