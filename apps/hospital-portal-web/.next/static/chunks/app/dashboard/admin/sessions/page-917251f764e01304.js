(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[275],{1757:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var a=s(2317);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=(...e)=>e.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:o="",children:c,iconNode:l,...d},u)=>(0,a.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:n?24*Number(s)/Number(t):s,className:r("lucide",o),...d},[...l.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(c)?c:[c]])),c=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...i},c)=>(0,a.createElement)(o,{ref:c,iconNode:t,className:r(`lucide-${n(e)}`,s),...i}));return s.displayName=`${e}`,s}},5541:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},9542:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8541:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},7109:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},982:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},1601:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5476:function(e,t,s){Promise.resolve().then(s.bind(s,5585))},5585:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(5650),n=s(2317),r=s(3966),i=s(9216);let o={getMySessions:async()=>(0,i.ac)().get("/session-management/my-sessions"),getUserSessions:async e=>(0,i.ac)().get("/session-management/user/".concat(e,"/sessions")),terminate:async(e,t)=>(0,i.ac)().post("/session-management/".concat(e,"/terminate"),{reason:t}),terminateAllExceptCurrent:async e=>(0,i.ac)().post("/session-management/terminate-all-except",{currentSessionId:e}),refresh:async e=>(0,i.ac)().post("/session-management/".concat(e,"/refresh"),{}),markSuspicious:async(e,t)=>(0,i.ac)().post("/session-management/".concat(e,"/mark-suspicious"),{reason:t}),getById:async e=>(0,i.ac)().get("/session-management/".concat(e))};var c=s(982),l=s(7109),d=s(1757);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,d.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var m=s(5541),g=s(1601),x=s(8541),p=s(9542);function h(){let{user:e}=(0,r.t)(),[t,s]=(0,n.useState)([]),[i,d]=(0,n.useState)(!0),[h,y]=(0,n.useState)(null),[f,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{e&&w()},[e]);let w=async()=>{try{d(!0),y(null);let e=await o.getMySessions();s(e.data||[])}catch(s){var e,t;console.error("Error loading sessions:",s),y((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load sessions")}finally{d(!1)}},j=async e=>{if(confirm("Are you sure you want to terminate this session?"))try{y(null),v(null),await o.terminate(e,"User-initiated termination"),v("Session terminated successfully"),await w()}catch(e){var t,s;y((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to terminate session")}},N=async()=>{if(confirm("Are you sure you want to terminate all other sessions? This will log you out from all other devices."))try{y(null),v(null);let e=t.find(e=>e.isActive);e&&(await o.terminateAllExceptCurrent(e.id),v("All other sessions terminated successfully"),await w())}catch(t){var e,s;y((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to terminate sessions")}},b=e=>(null==e?void 0:e.toLowerCase())==="mobile"?(0,a.jsx)(c.Z,{className:"text-blue-600",size:20}):(0,a.jsx)(l.Z,{className:"text-gray-600",size:20}),S=e=>e>=80?"text-green-600":e>=50?"text-yellow-600":"text-red-600";if(i)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})});let k=t.filter(e=>e.isActive),A=t.filter(e=>!e.isActive);return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Active Sessions"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Manage your active login sessions across devices"})]}),k.length>1&&(0,a.jsxs)("button",{onClick:N,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium flex items-center space-x-2",children:[(0,a.jsx)(u,{size:18}),(0,a.jsx)("span",{children:"Terminate All Others"})]})]}),h&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:h}),f&&(0,a.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:f}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Active Sessions (",k.length,")"]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:k.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-2 ".concat(e.isSuspicious?"border-red-300":"border-gray-200"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[b(e.sessionType),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900",children:[e.sessionType||"Unknown"," Session"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.loginMethod})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(m.Z,{className:S(e.securityScore),size:16}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat(S(e.securityScore)),children:[e.securityScore,"/100"]})]}),e.isSuspicious&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 mt-1",children:[(0,a.jsx)(g.Z,{size:12,className:"mr-1"}),"Suspicious"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.location&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{size:16}),(0,a.jsx)("span",{children:e.location})]}),e.ipAddress&&(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["IP: ",e.ipAddress]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{size:16}),(0,a.jsxs)("span",{children:["Started: ",new Date(e.loginTime).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Last activity: ",new Date(e.lastActivityTime).toLocaleString()]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Expires: ",new Date(e.expiresAt).toLocaleString()]})]}),e.isSuspicious&&e.suspiciousReason&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Suspicious Activity Detected"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:e.suspiciousReason})]}),(0,a.jsx)("button",{onClick:()=>j(e.id),className:"w-full px-3 py-2 text-sm font-medium text-red-600 bg-red-50 rounded hover:bg-red-100",children:"Terminate Session"})]},e.id))}),0===k.length&&(0,a.jsxs)("div",{className:"text-center py-8 bg-white rounded-lg shadow",children:[(0,a.jsx)(m.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No active sessions"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"You don't have any active sessions at the moment."})]})]}),A.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Sessions"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Login Time"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Logout Time"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:A.slice(0,10).map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[b(e.sessionType),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-900",children:e.sessionType})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.location||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.loginTime).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.logoutTime?new Date(e.logoutTime).toLocaleString():"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.status})})]},e.id))})]})})]})]})}},9216:function(e,t,s){"use strict";let a;s.d(t,{Di:function(){return c},J2:function(){return g},WU:function(){return x},ac:function(){return o},g8:function(){return u},h0:function(){return m},h5:function(){return l},iJ:function(){return d},qN:function(){return i},sl:function(){return p}});var n=s(6470),r=s(3966);s(2189);let i=()=>((a=n.Z.create({baseURL:"http://localhost:5073/api",headers:{"Content-Type":"application/json"}})).interceptors.request.use(e=>{let{tenantId:t,token:s}=r.t.getState();return t&&(e.headers["X-Tenant-ID"]=t),s&&(e.headers.Authorization="Bearer ".concat(s)),e}),a.interceptors.response.use(e=>e,e=>{var t,s;return(null===(t=e.response)||void 0===t?void 0:t.status)===401?(r.t.getState().logout(),window.location.href="/auth/login"):(null===(s=e.response)||void 0===s?void 0:s.status)===403&&(window.location.href="/dashboard/unauthorized"),Promise.reject(e)}),a),o=()=>a||i(),c={getAll:()=>o().get("/patients"),getById:e=>o().get("/patients/".concat(e)),create:e=>o().post("/patients",e),update:(e,t)=>o().put("/patients/".concat(e),t),delete:e=>o().delete("/patients/".concat(e))},l={getAll:()=>o().get("/examinations"),getById:e=>o().get("/examinations/".concat(e)),getByPatient:e=>o().get("/examinations/patient/".concat(e)),create:e=>o().post("/examinations",e),update:(e,t)=>o().put("/examinations/".concat(e),t),delete:e=>o().delete("/examinations/".concat(e))},d={login:(e,t,s)=>o().post("/auth/login",{email:e,password:t,tenantId:s}),changePassword:(e,t)=>o().post("/auth/change-password",{currentPassword:e,newPassword:t})},u={getAll:()=>o().get("/users"),getAllWithDetails:()=>o().get("/users/with-details"),getById:e=>o().get("/users/".concat(e)),create:e=>o().post("/users",e),update:(e,t)=>o().put("/users/".concat(e),t),deactivate:e=>o().post("/users/".concat(e,"/deactivate"))},m={getAll:()=>o().get("/roles"),getAllWithUserCount:()=>o().get("/roles/with-user-count"),getById:e=>o().get("/roles/".concat(e)),create:e=>o().post("/roles",e),update:(e,t)=>o().put("/roles/".concat(e),t),delete:e=>o().delete("/roles/".concat(e)),assignRole:(e,t,s)=>o().post("/users/".concat(e,"/roles"),{roleId:t,branchId:s}),getRolePermissions:e=>o().get("/roles/".concat(e,"/permissions")),assignPermissions:(e,t)=>o().post("/roles/".concat(e,"/permissions"),{permissionIds:t}),removePermissions:(e,t)=>o().delete("/roles/".concat(e,"/permissions"),{data:{permissionIds:t}}),cloneRole:(e,t,s)=>o().post("/roles/".concat(e,"/clone"),{name:t,description:s})},g={getAll:()=>o().get("/permissions"),getAllGrouped:()=>o().get("/permissions/grouped"),getById:e=>o().get("/permissions/".concat(e)),create:e=>o().post("/permissions",e),update:(e,t)=>o().put("/permissions/".concat(e),t),delete:e=>o().delete("/permissions/".concat(e)),getByCategory:e=>o().get("/permissions/category/".concat(e)),bulkAssign:(e,t)=>o().post("/permissions/bulk-assign",{roleId:e,permissionIds:t}),bulkRemove:(e,t)=>o().delete("/permissions/bulk-remove",{data:{roleId:e,permissionIds:t}}),getMatrix:()=>o().get("/permissions/matrix"),getStatistics:()=>o().get("/permissions/statistics")},x={getAll:()=>o().get("/departments"),getAllWithStaffCount:()=>o().get("/departments/with-staff-count"),getById:e=>o().get("/departments/".concat(e))},p={getAll:()=>o().get("/branches")}},2189:function(e,t,s){"use strict";s.d(t,{f:function(){return n}});var a=s(9216);let n={assign:async function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.ac)().post("/users/".concat(e,"/department-access"),{departmentId:t,accessLevel:s,isPrimary:n})},revoke:async(e,t)=>(0,a.ac)().delete("/users/".concat(e,"/department-access/").concat(t)),getUserDepartments:async e=>{let t=await (0,a.ac)().get("/users/".concat(e,"/department-access"));return t.data},getDepartmentUsers:async e=>(0,a.ac)().get("/departments/".concat(e,"/user-access")),updateAccessLevel:async(e,t,s)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{accessLevel:s}),setPrimary:async(e,t)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{isPrimary:!0}),bulkAssign:async e=>(0,a.ac)().post("/user-department-access/bulk-assign",{assignments:e}),getAccessMatrix:async e=>{let t=e?{departmentId:e}:{};return(0,a.ac)().get("/user-department-access/matrix",{params:t})}}},3966:function(e,t,s){"use strict";s.d(t,{R:function(){return r},t:function(){return n}});var a=s(9147);let n=(0,a.Ue)((e,t)=>({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],isLoading:!1,mustChangePassword:!1,setAuth:(t,s,a,n,r,i,o)=>{e({token:t,refreshToken:s,user:a,roles:n,permissions:r,tenantId:i,mustChangePassword:o}),localStorage.setItem("auth_token",t),localStorage.setItem("refresh_token",s),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("roles",JSON.stringify(n)),localStorage.setItem("permissions",JSON.stringify(r)),localStorage.setItem("tenant_id",i)},logout:()=>{e({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],mustChangePassword:!1}),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("tenant_id")},clearMustChangePassword:()=>e({mustChangePassword:!1}),hasPermission:e=>{let{permissions:s}=t();return!!(s&&Array.isArray(s))&&(!!s.includes("*")||s.includes(e))},hasRole:e=>{let{roles:s}=t();return!!(s&&Array.isArray(s))&&s.includes(e)}}));function r(){try{let e=localStorage.getItem("auth_token"),t=localStorage.getItem("refresh_token"),s=localStorage.getItem("user"),a=localStorage.getItem("roles"),r=localStorage.getItem("permissions"),i=localStorage.getItem("tenant_id");if(e&&s){let o=JSON.parse(s),c=a?JSON.parse(a):[],l=r?JSON.parse(r):[];n.getState().setAuth(e,t||null,o,c,l,i||null,n.getState().mustChangePassword)}}catch(e){console.warn("Failed to hydrate auth from storage",e)}}}},function(e){e.O(0,[675,510,662,744],function(){return e(e.s=5476)}),_N_E=e.O()}]);