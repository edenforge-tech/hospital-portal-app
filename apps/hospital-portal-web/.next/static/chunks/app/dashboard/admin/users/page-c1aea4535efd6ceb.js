(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{1215:function(e,t,s){Promise.resolve().then(s.bind(s,2456))},2456:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(5650),r=s(2317),l=s(9216);function n(e){let{initialUser:t,onClose:s}=e,[n,i]=(0,r.useState)(!1),[d,o]=(0,r.useState)({id:(null==t?void 0:t.id)||"",firstName:(null==t?void 0:t.firstName)||"",lastName:(null==t?void 0:t.lastName)||"",email:(null==t?void 0:t.email)||"",userName:(null==t?void 0:t.userName)||"",userType:(null==t?void 0:t.userType)||"Staff"}),c=e=>{o({...d,[e.target.name]:e.target.value})},m=async e=>{e.preventDefault(),i(!0);try{d.id?await l.g8.update(d.id,d):await l.g8.create(d),null==s||s()}catch(e){var t,a;alert((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to save user")}finally{i(!1)}};return(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"First Name"}),(0,a.jsx)("input",{name:"firstName",value:d.firstName,onChange:c,className:"w-full border px-3 py-2 rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"Last Name"}),(0,a.jsx)("input",{name:"lastName",value:d.lastName,onChange:c,className:"w-full border px-3 py-2 rounded"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"Email"}),(0,a.jsx)("input",{name:"email",value:d.email,onChange:c,className:"w-full border px-3 py-2 rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"Username"}),(0,a.jsx)("input",{name:"userName",value:d.userName,onChange:c,className:"w-full border px-3 py-2 rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"User Type"}),(0,a.jsxs)("select",{name:"userType",value:d.userType,onChange:c,className:"w-full border px-3 py-2 rounded",children:[(0,a.jsx)("option",{value:"Staff",children:"Staff"}),(0,a.jsx)("option",{value:"Admin",children:"Admin"}),(0,a.jsx)("option",{value:"Patient",children:"Patient"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-indigo-600 text-white rounded",children:n?"Saving...":"Save"})]})]})}var i=s(8989),d=s(8723),o=s(5924),c=s(711),m=s(1433),u=s(2189);let p=[{value:"Full Access",label:"Full Access",description:"Can view, edit, and delete"},{value:"ReadOnly",label:"Read Only",description:"Can only view data"},{value:"ApprovalOnly",label:"Approval Only",description:"Can approve/reject only"}];function x(e){let{userId:t,userName:s,onClose:n}=e,[x,g]=(0,r.useState)([]),[h,v]=(0,r.useState)([]),[y,f]=(0,r.useState)(!1),[b,N]=(0,r.useState)(!1),[j,w]=(0,r.useState)(""),[D,S]=(0,r.useState)(""),[A,C]=(0,r.useState)(""),[k,I]=(0,r.useState)([]),[P,L]=(0,r.useState)("Full Access"),[F,U]=(0,r.useState)(!1);(0,r.useEffect)(()=>{R()},[t]);let R=async()=>{f(!0),w("");try{let[e,s]=await Promise.all([l.WU.getAll(),u.f.getUserDepartments(t)]);console.log("\uD83D\uDD0D Raw departments response:",e),console.log("\uD83D\uDD0D Departments length:",null==e?void 0:e.length),console.log("\uD83D\uDD0D First department:",null==e?void 0:e[0]),console.log("\uD83D\uDD0D User departments:",s),console.log("\uD83D\uDD0D User departments type:",typeof s,Array.isArray(s));let a=Array.isArray(e)?e:[],r=Array.isArray(s)?s:[];g(a),v(r),console.log("✅ State updated - departments:",a.length,"user depts:",r.length)}catch(t){var e,s;console.error("❌ Failed to load department data:",t),w((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||t.message||"Failed to load data")}finally{f(!1)}},_=async()=>{if(!k.length){w("Please select at least one department");return}let e=h.map(e=>e.departmentId),s=k.filter(t=>!e.includes(t.id));if(!s.length){w("All selected departments are already assigned");return}N(!0),w(""),S("");try{let e=s.map(e=>({userId:t,departmentId:e.id,accessType:P,isPrimary:F}));await u.f.bulkAssign(e),S("Department access assigned successfully"),I([]),L("Full Access"),U(!1),await R()}catch(e){var a,r;w((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to assign department access")}finally{N(!1)}},O=async e=>{if(confirm("Are you sure you want to revoke access to this department?")){N(!0),w(""),S("");try{await u.f.revoke(t,e),S("Department access revoked successfully"),await R()}catch(e){var s,a;w((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to revoke access")}finally{N(!1)}}},B=async e=>{N(!0),w(""),S("");try{await u.f.setPrimary(t,e),S("Primary department updated successfully"),await R()}catch(e){var s,a;w((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to set primary department")}finally{N(!1)}},T=async(e,s)=>{N(!0),w(""),S("");try{await u.f.updateAccessLevel(t,e,s),S("Access level updated successfully"),await R()}catch(e){var a,r;w((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.message)||"Failed to update access level")}finally{N(!1)}},E=h.map(e=>e.departmentId),J=x.filter(e=>!E.includes(e.id)),M=J.filter(e=>{var t;return e.departmentName.toLowerCase().includes(A.toLowerCase())||(null===(t=e.departmentCode)||void 0===t?void 0:t.toLowerCase().includes(A.toLowerCase()))}),W=M.map(e=>({value:e.id,label:"".concat(e.departmentCode," - ").concat(e.departmentName).concat(e.parentDepartmentName?" (".concat(e.parentDepartmentName,")"):""),dept:e}));return console.log("\uD83D\uDD0D Render - allDepartments:",x.length),console.log("\uD83D\uDD0D Render - availableDepartments:",J.length),console.log("\uD83D\uDD0D Render - filteredDepartments:",M.length),console.log("\uD83D\uDD0D Render - searchTerm:",A),(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Manage Department Access"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["User: ",(0,a.jsx)("span",{className:"font-medium",children:s})]})]}),(0,a.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[j&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:j}),D&&(0,a.jsxs)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5"}),D]}),y?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assign New Department"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search departments...",value:A,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(i.ZP,{isMulti:!0,options:W,value:W.filter(e=>k.some(t=>t.id===e.value)),onChange:e=>{I(Array.isArray(e)?e.map(e=>e.dept):[])},placeholder:"Select departments...",classNamePrefix:"react-select",styles:{menu:e=>({...e,zIndex:9999})},isDisabled:b,noOptionsMessage:()=>A?"No departments found":"No departments available"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Level *"}),(0,a.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,a.jsxs)("label",{className:"flex items-start p-3 border border-gray-200 rounded-md cursor-pointer hover:bg-gray-50",children:[(0,a.jsx)("input",{type:"radio",name:"accessLevel",value:e.value,checked:P===e.value,onChange:e=>L(e.target.value),className:"mt-1 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.label}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.value))}),(0,a.jsxs)("label",{className:"flex items-center mt-3 p-3 bg-indigo-50 border border-indigo-200 rounded-md cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:F,onChange:e=>U(e.target.checked),className:"mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-indigo-900",children:"Set as Primary Department"}),(0,a.jsx)("div",{className:"text-xs text-indigo-700",children:"User's default department for login"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{onClick:_,disabled:b||!k.length,className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Assigning...":"Assign Department"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Current Departments (",h.length,")"]}),0===h.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 border border-gray-200 rounded-lg",children:"No department assignments yet"}):(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsx)("div",{className:"p-4 border rounded-lg ".concat(e.isPrimary?"border-indigo-300 bg-indigo-50":"border-gray-200 bg-white"),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.departmentName}),e.isPrimary&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800",children:"Primary"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Code: ",e.departmentCode]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Access Level:"}),(0,a.jsx)("select",{value:e.accessType,onChange:t=>T(e.departmentId,t.target.value),disabled:b,className:"ml-2 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-indigo-500 focus:border-indigo-500",children:p.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[!e.isPrimary&&(0,a.jsx)("button",{onClick:()=>B(e.departmentId),disabled:b,className:"text-indigo-600 hover:text-indigo-800 text-sm font-medium disabled:opacity-50",children:"Set Primary"}),(0,a.jsx)("button",{onClick:()=>O(e.departmentId),disabled:b,className:"text-red-600 hover:text-red-800 disabled:opacity-50",title:"Revoke Access",children:(0,a.jsx)(m.Z,{className:"h-5 w-5"})})]})]})},e.departmentId))})]})]})]}),(0,a.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end",children:(0,a.jsx)("button",{onClick:n,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})})}function g(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[d,o]=(0,r.useState)(""),[c,m]=(0,r.useState)(null),[u,p]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[v,y]=(0,r.useState)(""),[f,b]=(0,r.useState)(""),[N,j]=(0,r.useState)(""),[w,D]=(0,r.useState)(""),[S,A]=(0,r.useState)(""),[C,k]=(0,r.useState)(""),[I,P]=(0,r.useState)([]),[L,F]=(0,r.useState)([]),[U,R]=(0,r.useState)([]),_=async()=>{i(!0);try{let e=await l.g8.getAllWithDetails();t(e.data||[])}catch(t){var e,s;o((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to fetch users")}finally{i(!1)}},O=async()=>{try{var e;let[t,s,a]=await Promise.all([l.h0.getAll(),l.WU.getAll(),l.sl.getAll()]);P(t.data||[]),F(s.data||[]),R((null===(e=a.data)||void 0===e?void 0:e.branches)||[])}catch(e){console.error("Failed to fetch filter options:",e)}};(0,r.useEffect)(()=>{_(),O()},[]);let B=e=>{m(e),p(!0)},T=async e=>{if(confirm("Are you sure you want to deactivate this user?"))try{await l.g8.deactivate(e),_()}catch(e){var t,s;o((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to deactivate user")}},E=e=>{y(e.id),b("".concat(e.firstName," ").concat(e.lastName)),h(!0)},J=e.filter(e=>{let t=""===N||e.firstName.toLowerCase().includes(N.toLowerCase())||e.lastName.toLowerCase().includes(N.toLowerCase())||e.email.toLowerCase().includes(N.toLowerCase()),s=""===w||e.roles&&e.roles.includes(w),a=""===S||e.departments&&e.departments.some(e=>e.departmentName===S),r=""===C||e.branch===C;return t&&s&&a&&r});return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"User Management"}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:()=>{m(null),p(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Create User"})})]}),d&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:d}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-4 grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,a.jsx)("input",{type:"text",value:N,onChange:e=>j(e.target.value),placeholder:"Search by name or email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),(0,a.jsxs)("select",{value:w,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"All Roles"}),I.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,a.jsxs)("select",{value:S,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"All Departments"}),L.map(e=>(0,a.jsx)("option",{value:e.departmentName,children:e.departmentName},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),(0,a.jsxs)("select",{value:C,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"All Branches"}),U.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roles"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departments"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:J.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.email}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.roles&&e.roles.length>0?e.roles.map((e,t)=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800",children:e},t)):(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"No roles"})})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex flex-col gap-1",children:e.departments&&e.departments.length>0?(0,a.jsxs)(a.Fragment,{children:[e.departments.slice(0,2).map((e,t)=>(0,a.jsxs)("span",{className:"text-sm",children:[e.departmentName,e.isPrimary&&(0,a.jsx)("span",{className:"ml-1 text-xs text-indigo-600 font-medium",children:"(Primary)"})]},t)),e.departments.length>2&&(0,a.jsxs)("button",{onClick:()=>E(e),className:"text-xs text-indigo-600 hover:text-indigo-800 text-left",children:["+",e.departments.length-2," more"]})]}):(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"No departments"})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.branch||(0,a.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ".concat("active"===e.userStatus?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.userStatus})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{onClick:()=>E(e),className:"text-indigo-600 hover:text-indigo-900 font-medium",children:"Manage Departments"}),(0,a.jsx)("button",{onClick:()=>B(e),className:"text-blue-600 hover:text-blue-900",children:"Edit User"}),(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-900",children:"Deactivate"})]})})]},e.id))})]}),0===J.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:N||w||S||C?"No users match your filters":"No users found"})]}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg w-full max-w-xl max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(n,{initialUser:c,onClose:()=>{p(!1),_()}})})}),g&&(0,a.jsx)(x,{userId:v,userName:f,onClose:()=>{h(!1),_()}})]})}},9216:function(e,t,s){"use strict";let a;s.d(t,{Di:function(){return d},J2:function(){return p},WU:function(){return x},ac:function(){return i},g8:function(){return m},h0:function(){return u},h5:function(){return o},iJ:function(){return c},qN:function(){return n},sl:function(){return g}});var r=s(6470),l=s(3966);s(2189);let n=()=>((a=r.Z.create({baseURL:"http://localhost:5073/api",headers:{"Content-Type":"application/json"}})).interceptors.request.use(e=>{let{tenantId:t,token:s}=l.t.getState();return t&&(e.headers["X-Tenant-ID"]=t),s&&(e.headers.Authorization="Bearer ".concat(s)),e}),a.interceptors.response.use(e=>e,e=>{var t,s;return(null===(t=e.response)||void 0===t?void 0:t.status)===401?(l.t.getState().logout(),window.location.href="/auth/login"):(null===(s=e.response)||void 0===s?void 0:s.status)===403&&(window.location.href="/dashboard/unauthorized"),Promise.reject(e)}),a),i=()=>a||n(),d={getAll:()=>i().get("/patients"),getById:e=>i().get("/patients/".concat(e)),create:e=>i().post("/patients",e),update:(e,t)=>i().put("/patients/".concat(e),t),delete:e=>i().delete("/patients/".concat(e))},o={getAll:()=>i().get("/examinations"),getById:e=>i().get("/examinations/".concat(e)),getByPatient:e=>i().get("/examinations/patient/".concat(e)),create:e=>i().post("/examinations",e),update:(e,t)=>i().put("/examinations/".concat(e),t),delete:e=>i().delete("/examinations/".concat(e))},c={login:(e,t,s)=>i().post("/auth/login",{email:e,password:t,tenantId:s}),changePassword:(e,t)=>i().post("/auth/change-password",{currentPassword:e,newPassword:t})},m={getAll:()=>i().get("/users"),getAllWithDetails:()=>i().get("/users/with-details"),getById:e=>i().get("/users/".concat(e)),create:e=>i().post("/users",e),update:(e,t)=>i().put("/users/".concat(e),t),deactivate:e=>i().post("/users/".concat(e,"/deactivate"))},u={getAll:()=>i().get("/roles"),getAllWithUserCount:()=>i().get("/roles/with-user-count"),getById:e=>i().get("/roles/".concat(e)),create:e=>i().post("/roles",e),update:(e,t)=>i().put("/roles/".concat(e),t),delete:e=>i().delete("/roles/".concat(e)),assignRole:(e,t,s)=>i().post("/users/".concat(e,"/roles"),{roleId:t,branchId:s}),getRolePermissions:e=>i().get("/roles/".concat(e,"/permissions")),assignPermissions:(e,t)=>i().post("/roles/".concat(e,"/permissions"),{permissionIds:t}),removePermissions:(e,t)=>i().delete("/roles/".concat(e,"/permissions"),{data:{permissionIds:t}}),cloneRole:(e,t,s)=>i().post("/roles/".concat(e,"/clone"),{name:t,description:s})},p={getAll:()=>i().get("/permissions"),getAllGrouped:()=>i().get("/permissions/grouped"),getById:e=>i().get("/permissions/".concat(e)),create:e=>i().post("/permissions",e),update:(e,t)=>i().put("/permissions/".concat(e),t),delete:e=>i().delete("/permissions/".concat(e)),getByCategory:e=>i().get("/permissions/category/".concat(e)),bulkAssign:(e,t)=>i().post("/permissions/bulk-assign",{roleId:e,permissionIds:t}),bulkRemove:(e,t)=>i().delete("/permissions/bulk-remove",{data:{roleId:e,permissionIds:t}}),getMatrix:()=>i().get("/permissions/matrix"),getStatistics:()=>i().get("/permissions/statistics")},x={getAll:()=>i().get("/departments"),getAllWithStaffCount:()=>i().get("/departments/with-staff-count"),getById:e=>i().get("/departments/".concat(e))},g={getAll:()=>i().get("/branches")}},2189:function(e,t,s){"use strict";s.d(t,{f:function(){return r}});var a=s(9216);let r={assign:async function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.ac)().post("/users/".concat(e,"/department-access"),{departmentId:t,accessLevel:s,isPrimary:r})},revoke:async(e,t)=>(0,a.ac)().delete("/users/".concat(e,"/department-access/").concat(t)),getUserDepartments:async e=>{let t=await (0,a.ac)().get("/users/".concat(e,"/department-access"));return t.data},getDepartmentUsers:async e=>(0,a.ac)().get("/departments/".concat(e,"/user-access")),updateAccessLevel:async(e,t,s)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{accessLevel:s}),setPrimary:async(e,t)=>(0,a.ac)().put("/users/".concat(e,"/department-access/").concat(t),{isPrimary:!0}),bulkAssign:async e=>(0,a.ac)().post("/user-department-access/bulk-assign",{assignments:e}),getAccessMatrix:async e=>{let t=e?{departmentId:e}:{};return(0,a.ac)().get("/user-department-access/matrix",{params:t})}}},3966:function(e,t,s){"use strict";s.d(t,{R:function(){return l},t:function(){return r}});var a=s(9147);let r=(0,a.Ue)((e,t)=>({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],isLoading:!1,mustChangePassword:!1,setAuth:(t,s,a,r,l,n,i)=>{e({token:t,refreshToken:s,user:a,roles:r,permissions:l,tenantId:n,mustChangePassword:i}),localStorage.setItem("auth_token",t),localStorage.setItem("refresh_token",s),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("roles",JSON.stringify(r)),localStorage.setItem("permissions",JSON.stringify(l)),localStorage.setItem("tenant_id",n)},logout:()=>{e({user:null,token:null,refreshToken:null,tenantId:null,roles:[],permissions:[],mustChangePassword:!1}),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("tenant_id")},clearMustChangePassword:()=>e({mustChangePassword:!1}),hasPermission:e=>{let{permissions:s}=t();return!!(s&&Array.isArray(s))&&(!!s.includes("*")||s.includes(e))},hasRole:e=>{let{roles:s}=t();return!!(s&&Array.isArray(s))&&s.includes(e)}}));function l(){try{let e=localStorage.getItem("auth_token"),t=localStorage.getItem("refresh_token"),s=localStorage.getItem("user"),a=localStorage.getItem("roles"),l=localStorage.getItem("permissions"),n=localStorage.getItem("tenant_id");if(e&&s){let i=JSON.parse(s),d=a?JSON.parse(a):[],o=l?JSON.parse(l):[];r.getState().setAuth(e,t||null,i,d,o,n||null,r.getState().mustChangePassword)}}catch(e){console.warn("Failed to hydrate auth from storage",e)}}}},function(e){e.O(0,[675,667,510,662,744],function(){return e(e.s=1215)}),_N_E=e.O()}]);