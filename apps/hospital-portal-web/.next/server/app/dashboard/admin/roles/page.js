(()=>{var e={};e.id=7237,e.ids=[7237],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},612:e=>{"use strict";e.exports=require("node:os")},5830:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2243:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>x,routeModule:()=>u,tree:()=>c});var t=r(9173),a=r(8318),i=r(3526),l=r.n(i),n=r(8996),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(s,o);let d=t.AppPageRouteModule,c=["",{children:["dashboard",{children:["admin",{children:["roles",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,425)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\roles\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6687)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6840)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,1403,23)),"next/dist/client/components/not-found-error"]}],x=["C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\roles\\page.tsx"],m="/dashboard/admin/roles/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new d({definition:{kind:a.x.APP_PAGE,page:"/dashboard/admin/roles/page",pathname:"/dashboard/admin/roles",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9091:(e,s,r)=>{Promise.resolve().then(r.bind(r,3966))},3966:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var t=r(3393),a=r(3884),i=r(7928),l=r(8661),n=r(722);function o({isOpen:e,onClose:s,roleId:r,roleName:a,onPermissionsUpdated:i}){let[o,d]=(0,l.useState)([]),[c,x]=(0,l.useState)(new Set),[m,p]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!1),[g,b]=(0,l.useState)(""),[y,f]=(0,l.useState)("all");(0,l.useEffect)(()=>{e&&r&&j()},[e,r]);let j=async()=>{p(!0);try{let e=await n.J2.getAllGrouped();d(e.data||[]);let s=await n.h0.getRolePermissions(r),t=s.data?.map(e=>e.id)||[];x(new Set(t))}catch(e){console.error("Error loading permissions:",e)}finally{p(!1)}},N=e=>{let s=new Set(c);s.has(e)?s.delete(e):s.add(e),x(s)},v=(e,s)=>{let r=new Set(c),t=s.every(e=>r.has(e.id));s.every(e=>!r.has(e.id)),t?s.forEach(e=>r.delete(e.id)):s.forEach(e=>r.add(e.id)),x(r)},w=async()=>{h(!0);try{let e=Array.from(c);await n.h0.assignPermissions(r,e),i(),s()}catch(e){console.error("Error saving permissions:",e),alert("Failed to save permissions. Please try again.")}finally{h(!1)}},C=o.map(e=>({...e,permissions:e.permissions.filter(s=>("all"===y||e.module===y)&&(""===g||s.name.toLowerCase().includes(g.toLowerCase())||s.code.toLowerCase().includes(g.toLowerCase())||s.description?.toLowerCase().includes(g.toLowerCase())))})).filter(e=>e.permissions.length>0),S=Array.from(new Set(o.map(e=>e.module)));return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Manage Permissions for ",a]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Assign or remove permissions from this role"})]}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})}),t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx("input",{type:"text",placeholder:"Search permissions...",value:g,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})}),t.jsx("div",{children:(0,t.jsxs)("select",{value:y,onChange:e=>f(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[t.jsx("option",{value:"all",children:"All Modules"}),S.map(e=>t.jsx("option",{value:e,children:e},e))]})})]})}),t.jsx("div",{className:"flex-1 overflow-auto max-h-[60vh]",children:m?(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),t.jsx("span",{className:"ml-2 text-gray-600",children:"Loading permissions..."})]}):(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[C.map(e=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsx("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:e.permissions.every(e=>c.has(e.id)),onChange:()=>v(e.module,e.permissions),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 capitalize",children:e.module.replace("_"," ")}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.permissions.length," permissions)"]})]})})}),t.jsx("div",{className:"p-4 space-y-3",children:e.permissions.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 border border-gray-100 rounded-lg hover:bg-gray-50",children:[t.jsx("input",{type:"checkbox",checked:c.has(e.id),onChange:()=>N(e.id),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),t.jsx("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-600",children:e.code}),e.isSystemPermission&&t.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"System"})]}),e.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Action: ",t.jsx("strong",{children:e.action})]}),(0,t.jsxs)("span",{children:["Scope: ",t.jsx("strong",{children:e.scope})]}),(0,t.jsxs)("span",{children:["Resource: ",t.jsx("strong",{children:e.resourceType})]})]})]})]},e.id))})]},e.module)),0===C.length&&(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0D"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No permissions found"}),t.jsx("p",{className:"text-gray-600",children:g?"Try a different search term":"No permissions available"})]})]})}),t.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[c.size," permission",1!==c.size?"s":""," assigned"]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",disabled:u,children:"Cancel"}),t.jsx("button",{onClick:w,disabled:u,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Saving...":"Save Permissions"})]})]})})]})}):null}function d(){let{user:e}=(0,a.t)();(0,i.useRouter)();let[s,r]=(0,l.useState)([]),[d,c]=(0,l.useState)(!0),[x,m]=(0,l.useState)(""),[p,u]=(0,l.useState)(!1),[h,g]=(0,l.useState)(null),[b,y]=(0,l.useState)({name:"",description:""}),[f,j]=(0,l.useState)(""),[N,v]=(0,l.useState)(""),[w,C]=(0,l.useState)(null),[S,k]=(0,l.useState)(!1),[P,q]=(0,l.useState)(null);(0,l.useEffect)(()=>{e&&A()},[e]);let A=async()=>{try{c(!0);let e=await n.h0.getAllWithUserCount();r(e.data||[])}catch(e){console.error("Error loading roles:",e),j("Failed to load roles")}finally{c(!1)}},D=async()=>{if(!b.name.trim()){j("Role name is required");return}try{await (0,n.ac)().post("/roles",b),v("Role created successfully"),u(!1),y({name:"",description:""}),A(),setTimeout(()=>v(""),3e3)}catch(e){j(e.response?.data?.message||"Failed to create role")}},_=e=>{g(e),y({name:e.name,description:e.description}),u(!0)},R=async e=>{if(confirm("Are you sure you want to delete this role?"))try{await (0,n.ac)().delete(`/roles/${e}`),v("Role deleted successfully"),A(),setTimeout(()=>v(""),3e3)}catch(e){j(e.response?.data?.message||"Failed to delete role")}},E=e=>{q({id:e.id,name:e.name}),k(!0)},L=async e=>{let s=prompt(`Enter name for cloned role (original: ${e.name}):`,`${e.name} (Copy)`);if(s&&s.trim())try{await n.h0.cloneRole(e.id,{name:s.trim(),description:e.description}),v("Role cloned successfully"),A(),setTimeout(()=>v(""),3e3)}catch(e){j(e.response?.data?.message||"Failed to clone role")}},U=s.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.description?.toLowerCase().includes(x.toLowerCase()));return d||!e?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading roles..."})]})}):(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Role Management"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Manage roles and permissions"})]}),t.jsx("button",{onClick:()=>{g(null),y({name:"",description:""}),u(!0)},className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition",children:"+ Create Role"})]}),N&&t.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg",children:N}),f&&(0,t.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[f,t.jsx("button",{onClick:()=>j(""),className:"float-right font-bold",children:"\xd7"})]}),t.jsx("div",{className:"mb-6",children:t.jsx("input",{type:"text",placeholder:"Search roles...",value:x,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})}),t.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:d?(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"Loading roles..."})]}):0===U.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDD10"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Roles Found"}),t.jsx("p",{className:"text-gray-600 mb-4",children:x?"Try a different search term":"Create your first role to get started"}),!x&&t.jsx("button",{onClick:()=>u(!0),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700",children:"Create Role"})]}):(0,t.jsxs)("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,t.jsxs)("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Count"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"font-medium text-gray-900",children:e.name})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"text-sm text-gray-600",children:e.description||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("button",{onClick:()=>C(w===e.id?null:e.id),className:"flex items-center gap-2 text-sm font-medium text-indigo-600 hover:text-indigo-800",children:[(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[e.userCount||0," users"]}),t.jsx("span",{className:"text-xs",children:w===e.id?"▼":"▶"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${!1!==e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:!1!==e.isActive?"Active":"Inactive"})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[t.jsx("button",{onClick:()=>_(e),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),t.jsx("button",{onClick:()=>E(e),className:"text-green-600 hover:text-green-900 mr-4",children:"Permissions"}),t.jsx("button",{onClick:()=>L(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Clone"}),t.jsx("button",{onClick:()=>R(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id),w===e.id&&e.users&&e.users.length>0&&t.jsx("tr",{className:"bg-gray-50",children:t.jsx("td",{colSpan:5,className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Assigned Users:"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:e.users.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-white px-3 py-2 rounded border",children:[(0,t.jsxs)("span",{className:"font-medium",children:[e.firstName," ",e.lastName]}),t.jsx("span",{className:"text-gray-400",children:"•"}),t.jsx("span",{className:"text-xs",children:e.email})]},e.id))})]})})})]}))})]})})]}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:[t.jsx("h2",{className:"text-2xl font-bold mb-6",children:h?"Edit Role":"Create New Role"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name *"}),t.jsx("input",{type:"text",value:b.name,onChange:e=>y({...b,name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., Doctor, Nurse, Admin"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),t.jsx("textarea",{value:b.description,onChange:e=>y({...b,description:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Describe the role's responsibilities...",rows:3})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{u(!1),g(null),y({name:"",description:""}),j("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:D,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:h?"Update":"Create"})]})]})}),S&&P&&t.jsx(o,{isOpen:S,onClose:()=>{k(!1),q(null)},roleId:P.id,roleName:P.name,onPermissionsUpdated:()=>{v("Permissions updated successfully"),A(),setTimeout(()=>v(""),3e3)}})]})}},425:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var t=r(8390);let a=(0,t.createProxy)(String.raw`C:\Users\Sam Aluri\Downloads\Hospital Portal\apps\hospital-portal-web\src\app\dashboard\admin\roles\page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,o=n}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[2723,4479,3698,5033,5136,1805,2765],()=>r(2243));module.exports=t})();