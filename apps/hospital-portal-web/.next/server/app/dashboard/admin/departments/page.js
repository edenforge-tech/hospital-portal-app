(()=>{var e={};e.id=520,e.ids=[520],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},612:e=>{"use strict";e.exports=require("node:os")},5830:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5666:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>m,routeModule:()=>u,tree:()=>o});var s=a(9173),r=a(8318),l=a(3526),n=a.n(l),d=a(8996),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);a.d(t,i);let c=s.AppPageRouteModule,o=["",{children:["dashboard",{children:["admin",{children:["departments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8828)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\departments\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,6687)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,6840)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,1403,23)),"next/dist/client/components/not-found-error"]}],m=["C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\departments\\page.tsx"],x="/dashboard/admin/departments/page",p={require:a,loadChunk:()=>Promise.resolve()},u=new c({definition:{kind:r.x.APP_PAGE,page:"/dashboard/admin/departments/page",pathname:"/dashboard/admin/departments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9933:(e,t,a)=>{Promise.resolve().then(a.bind(a,3805))},3805:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(3393),r=a(3884),l=a(722);let n={getAll:async e=>{let t=await (0,l.ac)().get("/departments",{params:e});return t.data},getAllWithStaffCount:async()=>{let e=await (0,l.ac)().get("/departments/with-staff-count");return e.data},getById:async e=>{let t=await (0,l.ac)().get(`/departments/${e}`);return t.data},create:async e=>{let t=await (0,l.ac)().post("/departments",e);return t.data},update:async(e,t)=>{let a=await (0,l.ac)().put(`/departments/${e}`,t);return a.data},delete:async e=>{await (0,l.ac)().delete(`/departments/${e}`)},getHierarchy:async e=>{let t=await (0,l.ac)().get("/departments/hierarchy",{params:{branchId:e}});return t.data},getSubDepartments:async e=>{let t=await (0,l.ac)().get(`/departments/${e}/sub-departments`);return t.data},getDetails:async e=>{let t=await (0,l.ac)().get(`/departments/${e}/details`);return t.data},getStaff:async e=>{let t=await (0,l.ac)().get(`/departments/${e}/staff`);return t.data},getMetrics:async e=>{let t=await (0,l.ac)().get(`/departments/${e}/metrics`);return t.data},getDepartmentTypes:async()=>{let e=await (0,l.ac)().get("/departments/types");return e.data}};var d=a(7928),i=a(8661),c=a.n(i);function o({searchTerm:e,onSearchChange:t,placeholder:a="Search...",filters:r=[],onClearFilters:l,className:n=""}){let d=e||r.some(e=>e.value);return(0,s.jsxs)("div",{className:`flex flex-col gap-4 md:flex-row md:items-center ${n}`,children:[s.jsx("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:a,value:e,onChange:e=>t(e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 pl-10 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200"}),s.jsx("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),r.map((e,t)=>s.jsx("div",{className:"min-w-[180px]",children:(0,s.jsxs)("select",{value:e.value,onChange:t=>e.onChange(t.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",children:[s.jsx("option",{value:"",children:e.label}),e.options.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))]})},t)),d&&l&&s.jsx("button",{onClick:l,className:"whitespace-nowrap rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Clear Filters"})]})}var m=a(6093);function x({icon:e,title:t,description:a,action:r}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-12 text-center",children:[e&&s.jsx("div",{className:"mb-4 text-6xl opacity-50",children:e}),s.jsx("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:t}),a&&s.jsx("p",{className:"mb-6 text-sm text-gray-600",children:a}),r&&s.jsx("button",{onClick:r.onClick,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:r.label})]})}let p=({department:e,onClose:t})=>{let[a,r]=(0,i.useState)(1),[d,o]=(0,i.useState)(!1),[m,x]=(0,i.useState)(null),[p,u]=(0,i.useState)({departmentCode:"",departmentName:"",departmentType:"",description:"",branchId:"",organizationId:"",parentDepartmentId:"",departmentHeadId:"",operatingHours:"",budget:0,currency:"INR",maxConcurrentPatients:50,approvalWorkflowRequired:!1,status:"Active"}),[h,g]=(0,i.useState)([]),[b,y]=(0,i.useState)([]),[j]=(0,i.useState)(["Clinical","Administrative","Support","Diagnostic","Therapeutic","Emergency","Surgical","Medical"]);(0,i.useEffect)(()=>{e&&u({departmentCode:e.departmentCode,departmentName:e.departmentName,departmentType:e.departmentType,description:e.description||"",branchId:e.branchId,organizationId:e.organizationId||"",parentDepartmentId:e.parentDepartmentId||"",departmentHeadId:e.departmentHeadId||"",operatingHours:e.operatingHours||"",budget:e.budget||0,currency:e.currency||"INR",maxConcurrentPatients:e.maxConcurrentPatients||50,approvalWorkflowRequired:e.approvalWorkflowRequired,status:e.status}),f()},[e]);let f=async()=>{try{let[t,a]=await Promise.all([n.getAll(),l.g8.getAll()]);g(t.filter(t=>t.id!==e?.id)),y(a.data||[])}catch(e){console.error("Error loading options:",e)}},N=(e,t)=>{u(a=>({...a,[e]:t}))},v=async()=>{try{o(!0),x(null),e?await n.update(e.id,p):await n.create(p),t(!0)}catch(e){console.error("Error saving department:",e),x(e.response?.data?.message||"Failed to save department")}finally{o(!1)}},w=[{number:1,title:"Basic Information"},{number:2,title:"Parent & Hierarchy"},{number:3,title:"Department Head"},{number:4,title:"Operating Hours"},{number:5,title:"Budget"},{number:6,title:"Workflow Settings"},{number:7,title:"Capacity Settings"}];return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:(0,s.jsxs)("div",{className:"max-h-[90vh] w-full max-w-3xl overflow-auto rounded-lg bg-white shadow-xl",children:[(0,s.jsxs)("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Department":"Create New Department"}),s.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),s.jsx("div",{className:"mt-4 flex items-center justify-between",children:w.map((e,t)=>(0,s.jsxs)(c().Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium ${a===e.number?"bg-blue-600 text-white":a>e.number?"bg-green-600 text-white":"bg-gray-200 text-gray-600"}`,children:a>e.number?"✓":e.number}),s.jsx("p",{className:"mt-1 hidden text-xs text-gray-600 md:block",children:e.title})]}),t<w.length-1&&s.jsx("div",{className:`h-0.5 flex-1 ${a>e.number?"bg-green-600":"bg-gray-200"}`})]},e.number))})]}),(0,s.jsxs)("div",{className:"p-6",children:[m&&s.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 p-3 text-sm text-red-800",children:m}),1===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department Code *"}),s.jsx("input",{type:"text",value:p.departmentCode,onChange:e=>N("departmentCode",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",placeholder:"DEPT001",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department Name *"}),s.jsx("input",{type:"text",value:p.departmentName,onChange:e=>N("departmentName",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",placeholder:"Cardiology",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department Type *"}),(0,s.jsxs)("select",{value:p.departmentType,onChange:e=>N("departmentType",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",required:!0,children:[s.jsx("option",{value:"",children:"Select Type"}),j.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),s.jsx("textarea",{value:p.description,onChange:e=>N("description",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",rows:3,placeholder:"Brief description of the department..."})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status *"}),(0,s.jsxs)("select",{value:p.status,onChange:e=>N("status",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",required:!0,children:[s.jsx("option",{value:"Active",children:"Active"}),s.jsx("option",{value:"Inactive",children:"Inactive"}),s.jsx("option",{value:"UnderMaintenance",children:"Under Maintenance"})]})]})]}),2===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Parent Department & Hierarchy"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parent Department (Optional)"}),(0,s.jsxs)("select",{value:p.parentDepartmentId,onChange:e=>N("parentDepartmentId",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",children:[s.jsx("option",{value:"",children:"None (Top-level department)"}),h.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.departmentName," (",e.departmentCode,")"]},e.id))]}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select a parent department to create a sub-department"})]})]}),3===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Department Head Assignment"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department Head (Optional)"}),(0,s.jsxs)("select",{value:p.departmentHeadId,onChange:e=>N("departmentHeadId",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",children:[s.jsx("option",{value:"",children:"Select Department Head"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," - ",e.email]},e.id))]})]})]}),4===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Operating Hours"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Operating Hours"}),s.jsx("input",{type:"text",value:p.operatingHours,onChange:e=>N("operatingHours",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",placeholder:"e.g., Mon-Fri 9:00 AM - 5:00 PM, Sat 9:00 AM - 1:00 PM"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Specify the department's operational hours"})]})]}),5===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Budget & Currency"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Budget"}),s.jsx("input",{type:"number",value:p.budget,onChange:e=>N("budget",parseFloat(e.target.value)),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",placeholder:"0",min:"0"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),(0,s.jsxs)("select",{value:p.currency,onChange:e=>N("currency",e.target.value),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",children:[s.jsx("option",{value:"INR",children:"INR (₹)"}),s.jsx("option",{value:"USD",children:"USD ($)"}),s.jsx("option",{value:"EUR",children:"EUR (€)"}),s.jsx("option",{value:"GBP",children:"GBP (\xa3)"})]})]})]})]}),6===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Approval Workflow Settings"}),(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:p.approvalWorkflowRequired,onChange:e=>N("approvalWorkflowRequired",e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600"}),s.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Require approval workflow for this department"})]}),s.jsx("p",{className:"text-sm text-gray-500",children:"When enabled, certain actions will require approval from department head or administrators"})]}),7===a&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Capacity Settings"}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Maximum Concurrent Patients"}),s.jsx("input",{type:"number",value:p.maxConcurrentPatients,onChange:e=>N("maxConcurrentPatients",parseInt(e.target.value)),className:"mt-1 w-full rounded-lg border border-gray-300 px-3 py-2",placeholder:"50",min:"1"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Maximum number of patients that can be handled concurrently"})]})]})]}),s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("button",{onClick:()=>{a>1&&r(a-1)},disabled:1===a,className:"rounded-lg border border-gray-300 bg-white px-4 py-2 font-medium text-gray-700 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"← Previous"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>t(!1),className:"rounded-lg border border-gray-300 bg-white px-4 py-2 font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),a<7?s.jsx("button",{onClick:()=>{a<7&&r(a+1)},className:"rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700",children:"Next →"}):s.jsx("button",{onClick:v,disabled:d,className:"rounded-lg bg-green-600 px-4 py-2 font-medium text-white hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50",children:d?"Saving...":e?"Update Department":"Create Department"})]})]})})]})})},u=({departmentId:e,onClose:t})=>{let[a,r]=(0,i.useState)(null),[l,d]=(0,i.useState)(!0),[c,o]=(0,i.useState)("info");(0,i.useEffect)(()=>{x()},[e]);let x=async()=>{try{d(!0);let t=await n.getDetails(e);r(t)}catch(e){console.error("Error loading department details:",e)}finally{d(!1)}};if(l)return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"rounded-lg bg-white p-8",children:[s.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"}),s.jsx("p",{children:"Loading details..."})]})});if(!a)return null;let{department:p,staff:u,subDepartments:h,metrics:g}=a;return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:(0,s.jsxs)("div",{className:"max-h-[90vh] w-full max-w-4xl overflow-auto rounded-lg bg-white shadow-xl",children:[(0,s.jsxs)("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:p.departmentName}),s.jsx("p",{className:"text-sm text-gray-600",children:p.departmentCode})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-4",children:[s.jsx("button",{onClick:()=>o("info"),className:`pb-2 text-sm font-medium ${"info"===c?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Information"}),(0,s.jsxs)("button",{onClick:()=>o("staff"),className:`pb-2 text-sm font-medium ${"staff"===c?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Staff (",u.length,")"]}),(0,s.jsxs)("button",{onClick:()=>o("subdepts"),className:`pb-2 text-sm font-medium ${"subdepts"===c?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Sub-Departments (",h.length,")"]}),s.jsx("button",{onClick:()=>o("metrics"),className:`pb-2 text-sm font-medium ${"metrics"===c?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Metrics"})]})]}),(0,s.jsxs)("div",{className:"p-6",children:["info"===c&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Department Type"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.departmentType})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Status"}),s.jsx("div",{className:"mt-1",children:s.jsx(m.O,{status:p.status})})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Department Head"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.departmentHeadName||"Not assigned"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Operating Hours"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.operatingHours||"Not specified"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Budget"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.budget?`${p.currency} ${p.budget.toLocaleString()}`:"Not specified"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Max Concurrent Patients"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.maxConcurrentPatients||"Not specified"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approval Workflow"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.approvalWorkflowRequired?"Required":"Not required"})]})]}),p.description&&(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Description"}),s.jsx("p",{className:"mt-1 text-gray-900",children:p.description})]})]}),"staff"===c&&s.jsx("div",{children:0===u.length?s.jsx("p",{className:"text-center text-gray-500",children:"No staff assigned to this department"}):s.jsx("div",{className:"space-y-2",children:u.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 p-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:[e.firstName," ",e.lastName]}),s.jsx("p",{className:"text-sm text-gray-600",children:e.email})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:e.designation||"Not specified"}),s.jsx(m.O,{status:e.status,size:"sm"})]})]},e.id))})}),"subdepts"===c&&s.jsx("div",{children:0===h.length?s.jsx("p",{className:"text-center text-gray-500",children:"No sub-departments"}):s.jsx("div",{className:"space-y-2",children:h.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 p-3",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.departmentName}),s.jsx("p",{className:"text-sm text-gray-600",children:e.departmentCode})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:e.departmentType}),s.jsx(m.O,{status:e.status,size:"sm"})]})]},e.id))})}),"metrics"===c&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Active Patients"}),s.jsx("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:g.activePatients})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Appointments Today"}),s.jsx("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:g.totalAppointmentsToday})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Average Wait Time"}),(0,s.jsxs)("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:[g.averageWaitTime," min"]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Utilization Rate"}),(0,s.jsxs)("p",{className:"mt-2 text-3xl font-semibold text-gray-900",children:[g.utilizationRate,"%"]})]})]})]}),s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:t,className:"rounded-lg bg-gray-600 px-4 py-2 font-medium text-white hover:bg-gray-700",children:"Close"})})})]})})},h=({onClose:e})=>{let[t,a]=(0,i.useState)([]),[r,l]=(0,i.useState)(!0),[d,c]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{o()},[]);let o=async()=>{try{l(!0);let e=await n.getHierarchy();a(e),c(new Set(e.map(e=>e.id)))}catch(e){console.error("Error loading hierarchy:",e)}finally{l(!1)}},x=e=>{c(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},p=(e,t=0)=>{let a=d.has(e.id),r=e.children&&e.children.length>0;return(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white p-3 hover:bg-gray-50",style:{marginLeft:`${24*t}px`},children:[r&&s.jsx("button",{onClick:()=>x(e.id),className:"flex h-6 w-6 items-center justify-center rounded hover:bg-gray-200",children:a?"▼":"▶"}),!r&&s.jsx("div",{className:"w-6"}),s.jsx("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.departmentName}),s.jsx("p",{className:"text-sm text-gray-600",children:e.departmentCode})]}),s.jsx(m.O,{status:e.status,size:"sm"}),s.jsx("span",{className:"text-sm text-gray-600",children:e.departmentType})]})}),(0,s.jsxs)("div",{className:"text-right",children:[e.departmentHeadName&&(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Head: ",e.departmentHeadName]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Staff: ",e.totalStaff]})]})]}),r&&a&&s.jsx("div",{className:"mt-2",children:e.children.map(e=>p(e,t+1))})]},e.id)};return r?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"rounded-lg bg-white p-8",children:[s.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"}),s.jsx("p",{children:"Loading hierarchy..."})]})}):s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:(0,s.jsxs)("div",{className:"max-h-[90vh] w-full max-w-5xl overflow-auto rounded-lg bg-white shadow-xl",children:[s.jsx("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Department Hierarchy"}),s.jsx("p",{className:"text-sm text-gray-600",children:"View organizational structure of all departments"})]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:"✕"})]})}),s.jsx("div",{className:"p-6",children:0===t.length?(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[s.jsx("p",{className:"text-4xl",children:"\uD83C\uDFE5"}),s.jsx("p",{className:"mt-2",children:"No departments found"})]}):s.jsx("div",{children:t.map(e=>p(e))})}),s.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx("button",{onClick:()=>c(new Set(t.map(e=>e.id))),className:"text-sm text-blue-600 hover:text-blue-700",children:"Expand All"}),s.jsx("button",{onClick:e,className:"rounded-lg bg-gray-600 px-4 py-2 font-medium text-white hover:bg-gray-700",children:"Close"})]})})]})})};function g(){let{user:e}=(0,r.t)();(0,d.useRouter)();let[t,a]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[g,b]=(0,i.useState)(!0),[y,j]=(0,i.useState)(null),[f,N]=(0,i.useState)(""),[v,w]=(0,i.useState)(""),[C,S]=(0,i.useState)(""),[k,D]=(0,i.useState)([]),[P,q]=(0,i.useState)(!1),[A,H]=(0,i.useState)(null),[I,T]=(0,i.useState)(!1),[E,M]=(0,i.useState)(!1);(0,i.useEffect)(()=>{e&&($(),R())},[e]),(0,i.useEffect)(()=>{_()},[t,f,v,C]);let $=async()=>{try{b(!0),j(null);let e=await n.getAllWithStaffCount();a(e)}catch(e){console.error("Error loading departments:",e),j(e.response?.data?.message||"Failed to load departments")}finally{b(!1)}},R=async()=>{try{let e=await n.getDepartmentTypes();D(e)}catch(e){console.error("Error loading department types:",e),D(["Clinical","Administrative","Support","Diagnostic","Therapeutic","Emergency","Surgical","Medical"])}},_=()=>{let e=[...t];if(f){let t=f.toLowerCase();e=e.filter(e=>e.departmentName.toLowerCase().includes(t)||e.departmentCode.toLowerCase().includes(t)||e.departmentHeadName?.toLowerCase().includes(t))}v&&(e=e.filter(e=>e.status===v)),C&&(e=e.filter(e=>e.departmentType===C)),c(e)},z=()=>{N(""),w(""),S("")},W=()=>{H(null),q(!0)},U=e=>{H(e),q(!0)},O=e=>{H(e),T(!0)},B=async e=>{if(confirm(`Are you sure you want to delete department "${e.departmentName}"?`))try{await n.delete(e.id),await $()}catch(e){alert(e.response?.data?.message||"Failed to delete department")}},F=async e=>{q(!1),H(null),e&&await $()};return g||!e?s.jsx("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"}),s.jsx("p",{className:"text-gray-600",children:"Loading departments..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,s.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Departments Management"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Manage hospital departments and their hierarchies"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>M(!0),className:"rounded-lg border border-gray-300 bg-white px-4 py-2 font-medium text-gray-700 hover:bg-gray-50",children:"\uD83D\uDCCA View Hierarchy"}),s.jsx("button",{onClick:W,className:"rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700",children:"+ Create Department"})]})]}),y&&s.jsx("div",{className:"mb-6 rounded-lg border border-red-300 bg-red-50 p-4",children:s.jsx("p",{className:"text-sm text-red-800",children:y})}),s.jsx("div",{className:"mb-6",children:s.jsx(o,{searchTerm:f,onSearchChange:N,placeholder:"Search by department name, code, or head...",filters:[{label:"All Statuses",value:v,options:[{label:"Active",value:"Active"},{label:"Inactive",value:"Inactive"},{label:"Under Maintenance",value:"UnderMaintenance"}],onChange:w},{label:"All Types",value:C,options:k.map(e=>({label:e,value:e})),onChange:S}],onClearFilters:z})}),(0,s.jsxs)("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Total Departments"}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:t.length})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-green-600",children:t.filter(e=>"Active"===e.status).length})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Total Staff"}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-blue-600",children:t.reduce((e,t)=>e+(t.staffCount||t.totalStaff||0),0)})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"With Sub-departments"}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-purple-600",children:t.filter(e=>(e.totalSubDepartments||0)>0).length})]})]}),s.jsx("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:0===l.length?s.jsx("div",{className:"p-8",children:s.jsx(x,{icon:"\uD83C\uDFE5",title:f||v||C?"No departments found":"No departments yet",description:f||v||C?"Try adjusting your search or filters":"Get started by creating your first department",action:f||v||C?{label:"Clear Filters",onClick:z}:{label:"Create Department",onClick:W}})}):s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[s.jsx("thead",{className:"border-b border-gray-200 bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Department"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Department Head"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Staff"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Sub-Depts"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:l.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.departmentName}),s.jsx("p",{className:"text-sm text-gray-500",children:e.departmentCode})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-sm text-gray-700",children:e.departmentType})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-sm text-gray-700",children:e.departmentHeadName||"-"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.staffCount||e.totalStaff||0})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.totalSubDepartments||0})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx(m.O,{status:e.status})}),s.jsx("td",{className:"px-6 py-4 text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>O(e),className:"text-blue-600 hover:text-blue-700",title:"View Details",children:"\uD83D\uDC41️"}),s.jsx("button",{onClick:()=>U(e),className:"text-gray-600 hover:text-gray-700",title:"Edit",children:"✏️"}),s.jsx("button",{onClick:()=>B(e),className:"text-red-600 hover:text-red-700",title:"Delete",children:"\uD83D\uDDD1️"})]})})]},e.id))})]})})})]}),P&&s.jsx(p,{department:A,onClose:F}),I&&A&&s.jsx(u,{departmentId:A.id,onClose:()=>{T(!1),H(null)}}),E&&s.jsx(h,{onClose:()=>M(!1)})]})}},8828:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var s=a(8390);let r=(0,s.createProxy)(String.raw`C:\Users\Sam Aluri\Downloads\Hospital Portal\apps\hospital-portal-web\src\app\dashboard\admin\departments\page.tsx`),{__esModule:l,$$typeof:n}=r,d=r.default,i=d}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[2723,4479,3698,5033,5136,1805,2765,6093],()=>a(5666));module.exports=s})();