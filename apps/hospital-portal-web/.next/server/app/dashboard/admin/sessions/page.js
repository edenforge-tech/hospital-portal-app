(()=>{var e={};e.id=5275,e.ids=[5275],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},612:e=>{"use strict";e.exports=require("node:os")},5830:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8872:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>x,routeModule:()=>u,tree:()=>d});var r=t(9173),a=t(8318),i=t(3526),n=t.n(i),l=t(8996),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=r.AppPageRouteModule,d=["",{children:["dashboard",{children:["admin",{children:["sessions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7109)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\sessions\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6687)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,6840)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,1403,23)),"next/dist/client/components/not-found-error"]}],x=["C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\sessions\\page.tsx"],m="/dashboard/admin/sessions/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new c({definition:{kind:a.x.APP_PAGE,page:"/dashboard/admin/sessions/page",pathname:"/dashboard/admin/sessions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9569:(e,s,t)=>{Promise.resolve().then(t.bind(t,5746))},5746:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var r=t(3393),a=t(8661),i=t(3884),n=t(722);let l={getMySessions:async()=>(0,n.ac)().get("/session-management/my-sessions"),getUserSessions:async e=>(0,n.ac)().get(`/session-management/user/${e}/sessions`),terminate:async(e,s)=>(0,n.ac)().post(`/session-management/${e}/terminate`,{reason:s}),terminateAllExceptCurrent:async e=>(0,n.ac)().post("/session-management/terminate-all-except",{currentSessionId:e}),refresh:async e=>(0,n.ac)().post(`/session-management/${e}/refresh`,{}),markSuspicious:async(e,s)=>(0,n.ac)().post(`/session-management/${e}/mark-suspicious`,{reason:s}),getById:async e=>(0,n.ac)().get(`/session-management/${e}`)};var o=t(4257),c=t(8569),d=t(8755),x=t(332),m=t(4714),p=t(7630),u=t(9291);function h(){let{user:e}=(0,i.t)(),[s,t]=(0,a.useState)([]),[n,h]=(0,a.useState)(!0),[g,y]=(0,a.useState)(null),[j,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&b()},[e]);let b=async()=>{try{h(!0),y(null);let e=await l.getMySessions();t(e.data||[])}catch(e){console.error("Error loading sessions:",e),y(e.response?.data?.message||"Failed to load sessions")}finally{h(!1)}},v=async e=>{if(confirm("Are you sure you want to terminate this session?"))try{y(null),f(null),await l.terminate(e,"User-initiated termination"),f("Session terminated successfully"),await b()}catch(e){y(e.response?.data?.message||"Failed to terminate session")}},w=async()=>{if(confirm("Are you sure you want to terminate all other sessions? This will log you out from all other devices."))try{y(null),f(null);let e=s.find(e=>e.isActive);e&&(await l.terminateAllExceptCurrent(e.id),f("All other sessions terminated successfully"),await b())}catch(e){y(e.response?.data?.message||"Failed to terminate sessions")}},N=e=>e?.toLowerCase()==="mobile"?r.jsx(o.Z,{className:"text-blue-600",size:20}):r.jsx(c.Z,{className:"text-gray-600",size:20}),S=e=>e>=80?"text-green-600":e>=50?"text-yellow-600":"text-red-600";if(n)return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})});let A=s.filter(e=>e.isActive),q=s.filter(e=>!e.isActive);return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Active Sessions"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Manage your active login sessions across devices"})]}),A.length>1&&(0,r.jsxs)("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium flex items-center space-x-2",children:[r.jsx(d.Z,{size:18}),r.jsx("span",{children:"Terminate All Others"})]})]}),g&&r.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:g}),j&&r.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:j}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Active Sessions (",A.length,")"]}),r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:A.map(e=>(0,r.jsxs)("div",{className:`bg-white rounded-lg shadow-md p-6 border-2 ${e.isSuspicious?"border-red-300":"border-gray-200"}`,children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[N(e.sessionType),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900",children:[e.sessionType||"Unknown"," Session"]}),r.jsx("p",{className:"text-xs text-gray-500",children:e.loginMethod})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx(x.Z,{className:S(e.securityScore),size:16}),(0,r.jsxs)("span",{className:`text-sm font-medium ${S(e.securityScore)}`,children:[e.securityScore,"/100"]})]}),e.isSuspicious&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 mt-1",children:[r.jsx(m.Z,{size:12,className:"mr-1"}),"Suspicious"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.location&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(p.Z,{size:16}),r.jsx("span",{children:e.location})]}),e.ipAddress&&r.jsx("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["IP: ",e.ipAddress]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(u.Z,{size:16}),(0,r.jsxs)("span",{children:["Started: ",new Date(e.loginTime).toLocaleString()]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Last activity: ",new Date(e.lastActivityTime).toLocaleString()]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Expires: ",new Date(e.expiresAt).toLocaleString()]})]}),e.isSuspicious&&e.suspiciousReason&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[r.jsx("p",{className:"font-semibold",children:"Suspicious Activity Detected"}),r.jsx("p",{className:"text-xs mt-1",children:e.suspiciousReason})]}),r.jsx("button",{onClick:()=>v(e.id),className:"w-full px-3 py-2 text-sm font-medium text-red-600 bg-red-50 rounded hover:bg-red-100",children:"Terminate Session"})]},e.id))}),0===A.length&&(0,r.jsxs)("div",{className:"text-center py-8 bg-white rounded-lg shadow",children:[r.jsx(x.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No active sessions"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You don't have any active sessions at the moment."})]})]}),q.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Sessions"}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Logout Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.slice(0,10).map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[N(e.sessionType),r.jsx("span",{className:"ml-2 text-sm text-gray-900",children:e.sessionType})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.location||"Unknown"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.loginTime).toLocaleString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.logoutTime?new Date(e.logoutTime).toLocaleString():"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.status})})]},e.id))})]})})]})]})}},7109:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>i,default:()=>o});var r=t(8390);let a=(0,r.createProxy)(String.raw`C:\Users\Sam Aluri\Downloads\Hospital Portal\apps\hospital-portal-web\src\app\dashboard\admin\sessions\page.tsx`),{__esModule:i,$$typeof:n}=a,l=a.default,o=l}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2723,4479,3698,5033,5235,6621,8832,6562,5136,1805,2765],()=>t(8872));module.exports=r})();