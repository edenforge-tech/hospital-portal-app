(()=>{var e={};e.id=6825,e.ids=[6825],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},612:e=>{"use strict";e.exports=require("node:os")},5830:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9029:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>c.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>p,routeModule:()=>u,tree:()=>o});var r=t(9173),a=t(8318),n=t(3526),c=t.n(n),i=t(8996),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(s,l);let d=r.AppPageRouteModule,o=["",{children:["dashboard",{children:["admin",{children:["emergency-access",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6180)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\emergency-access\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6687)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,6840)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,1403,23)),"next/dist/client/components/not-found-error"]}],p=["C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\dashboard\\admin\\emergency-access\\page.tsx"],m="/dashboard/admin/emergency-access/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new d({definition:{kind:a.x.APP_PAGE,page:"/dashboard/admin/emergency-access/page",pathname:"/dashboard/admin/emergency-access",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8640:(e,s,t)=>{Promise.resolve().then(t.bind(t,6526))},6526:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(3393),a=t(8661),n=t(3884),c=t(722);let i={request:async e=>(0,c.ac)().post("/emergency-access/request",e),getMyRequests:async()=>(0,c.ac)().get("/emergency-access/my-requests"),getPendingApprovals:async()=>(0,c.ac)().get("/emergency-access/pending-approvals"),getActive:async e=>{let s=e?`/emergency-access/active?userId=${e}`:"/emergency-access/active";return(0,c.ac)().get(s)},approve:async(e,s)=>(0,c.ac)().post(`/emergency-access/${e}/approve`,s),reject:async(e,s)=>(0,c.ac)().post(`/emergency-access/${e}/reject`,s),revoke:async(e,s)=>(0,c.ac)().post(`/emergency-access/${e}/revoke`,{reason:s}),getById:async e=>(0,c.ac)().get(`/emergency-access/${e}`),getHistory:async e=>{let s=e?`/emergency-access/history?userId=${e}`:"/emergency-access/history";return(0,c.ac)().get(s)}};var l=t(4098),d=t(1700),o=t(9291),p=t(4714),m=t(5171),x=t(8935);function u(){let{user:e}=(0,n.t)(),[s,t]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[g,h]=(0,a.useState)([]),[y,b]=(0,a.useState)(!0),[j,v]=(0,a.useState)(null),[f,N]=(0,a.useState)(null),[w,q]=(0,a.useState)(!1),[P,S]=(0,a.useState)({reason:"",emergencyType:"Medical",patientId:void 0,durationMinutes:60,grantedPermissions:["patient.view","patient.edit"],scope:"Limited"});(0,a.useEffect)(()=>{e&&A()},[e]);let A=async()=>{try{b(!0),v(null);let[e,s,r]=await Promise.all([i.getMyRequests(),i.getPendingApprovals().catch(()=>({data:[]})),i.getActive()]);t(e.data||[]),u(s.data||[]),h(r.data||[])}catch(e){console.error("Error loading emergency access data:",e),v(e.response?.data?.message||"Failed to load data")}finally{b(!1)}},C=async e=>{if(e.preventDefault(),!P.reason.trim()){v("Reason is required");return}try{v(null),N(null),await i.request(P),N("Emergency access requested successfully"),q(!1),S({reason:"",emergencyType:"Medical",patientId:void 0,durationMinutes:60,grantedPermissions:["patient.view","patient.edit"],scope:"Limited"}),await A()}catch(e){v(e.response?.data?.message||"Failed to request emergency access")}},k=async e=>{let s=prompt("Enter approval notes (optional):");try{v(null),N(null),await i.approve(e,{notes:s||void 0}),N("Emergency access approved successfully"),await A()}catch(e){v(e.response?.data?.message||"Failed to approve emergency access")}},E=async e=>{let s=prompt("Enter rejection reason:");if(s)try{v(null),N(null),await i.reject(e,{reason:s}),N("Emergency access rejected successfully"),await A()}catch(e){v(e.response?.data?.message||"Failed to reject emergency access")}},M=async e=>{let s=prompt("Enter revocation reason:");if(s)try{v(null),N(null),await i.revoke(e,s),N("Emergency access revoked successfully"),await A()}catch(e){v(e.response?.data?.message||"Failed to revoke emergency access")}},_=e=>{let s={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",active:"bg-blue-100 text-blue-800",expired:"bg-gray-100 text-gray-800",revoked:"bg-red-100 text-red-800",rejected:"bg-red-100 text-red-800"};return s[e]||s.pending},R=e=>{switch(e){case"approved":case"active":return r.jsx(l.Z,{className:"text-green-600",size:20});case"rejected":case"revoked":return r.jsx(d.Z,{className:"text-red-600",size:20});case"pending":return r.jsx(o.Z,{className:"text-yellow-600",size:20});default:return r.jsx(p.Z,{className:"text-gray-600",size:20})}};return y?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center space-x-2",children:[r.jsx(m.Z,{size:32,className:"text-red-600"}),r.jsx("span",{children:"Emergency Access"})]}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Request and manage emergency access to protected resources"})]}),(0,r.jsxs)("button",{onClick:()=>q(!w),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium flex items-center space-x-2",children:[r.jsx(p.Z,{size:18}),r.jsx("span",{children:"Request Emergency Access"})]})]}),j&&r.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:j}),f&&r.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:f}),w&&(0,r.jsxs)("div",{className:"mb-8 bg-white rounded-lg shadow-md p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Request Emergency Access"}),(0,r.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Type"}),(0,r.jsxs)("select",{value:P.emergencyType,onChange:e=>S({...P,emergencyType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[r.jsx("option",{value:"Medical",children:"Medical Emergency"}),r.jsx("option",{value:"LifeThreatening",children:"Life-Threatening"}),r.jsx("option",{value:"Critical",children:"Critical Care"}),r.jsx("option",{value:"Urgent",children:"Urgent"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason for Request ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx("textarea",{value:P.reason,onChange:e=>S({...P,reason:e.target.value}),rows:4,placeholder:"Describe the emergency situation and why access is needed...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (minutes)"}),r.jsx("input",{type:"number",value:P.durationMinutes,onChange:e=>S({...P,durationMinutes:parseInt(e.target.value)}),min:"15",max:"240",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Access Scope"}),(0,r.jsxs)("select",{value:P.scope,onChange:e=>S({...P,scope:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[r.jsx("option",{value:"Limited",children:"Limited"}),r.jsx("option",{value:"Full",children:"Full"}),r.jsx("option",{value:"Specific",children:"Specific"})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:()=>q(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Submit Request"})]})]})]}),g.length>0&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[r.jsx(x.Z,{className:"text-blue-600",size:20}),r.jsx("span",{children:"Active Emergency Access"})]}),r.jsx("div",{className:"grid gap-4",children:g.map(e=>(0,r.jsxs)("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:e.emergencyType}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.reason})]}),r.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${_(e.status)}`,children:e.status})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Code:"})," ",e.accessCode||"N/A"]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Scope:"})," ",e.scope]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Expires:"})," ",new Date(e.endTime).toLocaleString()]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Duration:"})," ",e.durationMinutes," minutes"]})]}),r.jsx("button",{onClick:()=>M(e.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Revoke Access"})]},e.id))})]}),c.length>0&&(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pending Approvals"}),r.jsx("div",{className:"space-y-4",children:c.map(e=>(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-300 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:e.emergencyType}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.reason})]}),R(e.status)]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm text-gray-600 mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Requested:"})," ",new Date(e.startTime).toLocaleString()]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Duration:"})," ",e.durationMinutes," minutes"]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"font-medium",children:"Scope:"})," ",e.scope]})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[r.jsx("button",{onClick:()=>k(e.id),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Approve"}),r.jsx("button",{onClick:()=>E(e.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Reject"})]})]},e.id))})]}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"My Requests"}),r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reason"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Requested"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.emergencyType}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.reason}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.startTime).toLocaleString()}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.durationMinutes," min"]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_(e.status)}`,children:e.status})})]},e.id))})]})})]})]})}},6180:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>c,__esModule:()=>n,default:()=>l});var r=t(8390);let a=(0,r.createProxy)(String.raw`C:\Users\Sam Aluri\Downloads\Hospital Portal\apps\hospital-portal-web\src\app\dashboard\admin\emergency-access\page.tsx`),{__esModule:n,$$typeof:c}=a,i=a.default,l=i}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[2723,4479,3698,5033,5235,6706,7961,5136,1805,2765],()=>t(9029));module.exports=r})();