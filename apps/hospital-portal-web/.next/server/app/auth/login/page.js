(()=>{var e={};e.id=6716,e.ids=[6716],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},612:e=>{"use strict";e.exports=require("node:os")},5830:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9431:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>g,originalPathname:()=>p,pages:()=>u,routeModule:()=>m,tree:()=>c});var r=s(9173),a=s(8318),o=s(3526),n=s.n(o),l=s(8996),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);s.d(t,i);let d=r.AppPageRouteModule,c=["",{children:["auth",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9708)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\auth\\login\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6698)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\auth\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,6840)),"C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,1403,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\Sam Aluri\\Downloads\\Hospital Portal\\apps\\hospital-portal-web\\src\\app\\auth\\login\\page.tsx"],p="/auth/login/page",g={require:s,loadChunk:()=>Promise.resolve()},m=new d({definition:{kind:a.x.APP_PAGE,page:"/auth/login/page",pathname:"/auth/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2661:(e,t,s)=>{Promise.resolve().then(s.bind(s,9748))},6892:()=>{},9748:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(3393),a=s(8661),o=s(7928),n=s(722),l=s(3884),i=s(2891);function d(){let e=(0,o.useRouter)(),t=(0,l.t)(e=>e.setAuth),[s,d]=(0,a.useState)("admin@hospital.com"),[c,u]=(0,a.useState)("Admin@123456"),[p,g]=(0,a.useState)(""),[m,h]=(0,a.useState)([]),[x,b]=(0,a.useState)(""),[y,f]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{try{let e;let t="http://localhost:5073/api";console.log("Fetching tenants from:",t);try{e=await i.Z.get(`${t}/tenants/debug/codes/db`,{timeout:3e3}),console.log("Database tenants response:",e.data)}catch(s){console.log("Database tenants not available, using mock data"),e=await i.Z.get(`${t}/tenants/debug/codes`,{timeout:3e3}),console.log("Mock tenants response:",e.data)}let s=[];if(e.data&&Array.isArray(e.data.tenants)?s=e.data.tenants:e.data&&Array.isArray(e.data)&&(s=e.data),console.log("Parsed tenants list:",s),s.length>0)h(s),g(s[0].id),console.log("Set tenants successfully:",s.length);else throw Error("No tenants found in response")}catch(t){console.error("Error fetching tenants:",t);let e=[{id:"11111111-1111-1111-1111-111111111111",name:"Apollo Hospitals - Main",tenantCode:"APOLLO-MAIN"},{id:"22222222-2222-2222-2222-222222222222",name:"Fortis Healthcare",tenantCode:"FORTIS-01"},{id:"33333333-3333-3333-3333-333333333333",name:"Max Healthcare",tenantCode:"MAX-HC"},{id:"44444444-4444-4444-4444-444444444444",name:"Narayana Health",tenantCode:"NARAYANA"},{id:"55555555-5555-5555-5555-555555555555",name:"Sankara Eye Hospital",tenantCode:"SANKARA"}];h(e),g(e[0].id),console.log("Using fallback tenants:",e.length)}finally{v(!1)}};e()},[]);let j=async()=>{b(""),f(!0);try{let e=(0,n.ac)(),t=p||"11111111-1111-1111-1111-111111111111";await e.post(`/auth/debug/create-admin?tenantId=${t}`),alert("Admin user created successfully! Email: admin@hospital.com, Password: Admin@123456"),d("admin@hospital.com"),u("Admin@123456"),g(t)}catch(t){console.error("Create admin error:",t);let e=t.response?.data?.message||t.response?.data?.error||t.message||"Failed to create admin user. Check backend logs.";b(e)}finally{f(!1)}},A=async r=>{r.preventDefault(),b(""),f(!0);try{(0,n.qN)(),console.log("Attempting login with:",{email:s,password:c,tenantId:p});let r=await n.iJ.login(s,c,p);console.log("Login response:",r);let{data:a}=r;if(console.log("Login data:",a),!a.success){console.log("Login failed - no success flag"),b(a.message||"Login failed");return}console.log("Login successful, calling setAuth..."),t(a.accessToken,a.refreshToken,a.user,a.roles,a.permissions,p,a.mustChangePassword),console.log("Auth state set, checking mustChangePassword:",a.mustChangePassword),a.mustChangePassword?(console.log("Redirecting to change password"),e.push("/auth/change-password")):(console.log("Redirecting to dashboard"),e.push("/dashboard"))}catch(t){console.error("Login error:",t);let e="An error occurred during login. ";t.response?.data?.message?e+=t.response.data.message:t.response?.data?.error?e+=t.response.data.error:t.message&&(e+=t.message),e.includes("An error occurred during login")&&!e.includes("user")&&(e+=' (Database may be empty. Try clicking "Create Admin User" below.)'),b(e)}finally{f(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-8 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-indigo-600",children:"Eye Hospital"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Hospital Management System"})]}),(0,r.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[x&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:x}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tenant"}),w?r.jsx("div",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:"Loading tenants..."}):m.length>0?(0,r.jsxs)("select",{value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white",required:!0,children:[r.jsx("option",{value:"",children:"Select your hospital"}),m.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}):r.jsx("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Enter your hospital tenant ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),r.jsx("input",{type:"email",value:s,onChange:e=>d(e.target.value),placeholder:"your@email.com",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),r.jsx("input",{type:"password",value:c,onChange:e=>u(e.target.value),placeholder:"••••••••",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),r.jsx("button",{type:"submit",disabled:y,className:"w-full bg-indigo-600 text-white py-2 rounded-lg font-semibold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:y?"Logging in...":"Login"}),r.jsx("button",{type:"button",onClick:j,disabled:y,className:"w-full mt-2 bg-green-600 text-white py-2 rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:y?"Creating...":"Create Admin User (Dev Only)"})]}),r.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:[r.jsx("strong",{children:"Demo Credentials:"}),r.jsx("br",{}),"Email: admin@hospital.com",r.jsx("br",{}),"Password: Use the one provided",r.jsx("br",{}),"Tenant: Select from dropdown above"]})})]})})}},6698:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>a});var r=s(304);let a={title:"Next.js",description:"Generated by Next.js"};function o({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{children:e})})}},9708:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>o,default:()=>i});var r=s(8390);let a=(0,r.createProxy)(String.raw`C:\Users\Sam Aluri\Downloads\Hospital Portal\apps\hospital-portal-web\src\app\auth\login\page.tsx`),{__esModule:o,$$typeof:n}=a,l=a.default,i=l}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[2723,4479,3698,5136,1805],()=>s(9431));module.exports=r})();